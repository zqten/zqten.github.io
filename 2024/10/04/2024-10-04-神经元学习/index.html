

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/inment.png">
  <link rel="icon" href="/img/inment.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="zqten">
  <meta name="keywords" content="">
  
    <meta name="description" content="ç¬¬ä¸€æ­¥ï¼šäº†è§£ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ ğŸ˜„çŸ©é˜µç‚¹ä¹˜è§„åˆ™ï¼šå½“çŸ©é˜µAçš„åˆ—æ•°ï¼ˆcolumnï¼‰ç­‰äºçŸ©é˜µBçš„è¡Œæ•°ï¼ˆrowï¼‰æ—¶ï¼ŒAä¸Bå¯ä»¥ç›¸ä¹˜  2è¡Œ3åˆ— * 3è¡Œ2åˆ— &#x3D; 2è¡Œ2åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰ 3è¡Œ2åˆ— * 2è¡Œ3åˆ— &#x3D; 3è¡Œ3åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰  ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç½‘ç»œçš„è®¡ç®—æ¨¡å‹ï¼Œç”¨äºå¤„ç†å¤æ‚çš„æ¨¡å¼è¯†åˆ«é—®é¢˜ã€‚å®ƒä»¬ç”±ä¸€ç³»åˆ—ç¥ç»å…ƒï¼ˆæˆ–ç§°èŠ‚ç‚¹ï¼‰ç»„æˆï¼Œè¿™äº›ç¥ç»å…ƒé€š">
<meta property="og:type" content="article">
<meta property="og:title" content="ç¥ç»å…ƒå­¦ä¹ ">
<meta property="og:url" content="http://example.com/2024/10/04/2024-10-04-%E7%A5%9E%E7%BB%8F%E5%85%83%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="å­¦æ— æ­¢å¢ƒ">
<meta property="og:description" content="ç¬¬ä¸€æ­¥ï¼šäº†è§£ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ ğŸ˜„çŸ©é˜µç‚¹ä¹˜è§„åˆ™ï¼šå½“çŸ©é˜µAçš„åˆ—æ•°ï¼ˆcolumnï¼‰ç­‰äºçŸ©é˜µBçš„è¡Œæ•°ï¼ˆrowï¼‰æ—¶ï¼ŒAä¸Bå¯ä»¥ç›¸ä¹˜  2è¡Œ3åˆ— * 3è¡Œ2åˆ— &#x3D; 2è¡Œ2åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰ 3è¡Œ2åˆ— * 2è¡Œ3åˆ— &#x3D; 3è¡Œ3åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰  ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç½‘ç»œçš„è®¡ç®—æ¨¡å‹ï¼Œç”¨äºå¤„ç†å¤æ‚çš„æ¨¡å¼è¯†åˆ«é—®é¢˜ã€‚å®ƒä»¬ç”±ä¸€ç³»åˆ—ç¥ç»å…ƒï¼ˆæˆ–ç§°èŠ‚ç‚¹ï¼‰ç»„æˆï¼Œè¿™äº›ç¥ç»å…ƒé€š">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-10-03T16:00:00.000Z">
<meta property="article:modified_time" content="2024-10-26T05:45:53.416Z">
<meta property="article:author" content="zqten">
<meta property="article:tag" content="ç¼–ç¨‹">
<meta property="article:tag" content="python">
<meta property="article:tag" content="AI">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>ç¥ç»å…ƒå­¦ä¹  - å­¦æ— æ­¢å¢ƒ</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-10-25T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>å­¦æ— æ­¢å¢ƒçš„åšå®¢</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.1)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ç¥ç»å…ƒå­¦ä¹ "></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-10-04 00:00" pubdate>
          2024å¹´10æœˆ4æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          14k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          114 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ç¥ç»å…ƒå­¦ä¹ </h1>
            
            
              <div class="markdown-body">
                
                <h2 id="ç¬¬ä¸€æ­¥ï¼šäº†è§£ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ">ç¬¬ä¸€æ­¥ï¼šäº†è§£ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>ğŸ˜„çŸ©é˜µç‚¹ä¹˜è§„åˆ™ï¼š<strong>å½“çŸ©é˜µAçš„åˆ—æ•°ï¼ˆcolumnï¼‰ç­‰äºçŸ©é˜µBçš„è¡Œæ•°ï¼ˆrowï¼‰æ—¶ï¼ŒAä¸Bå¯ä»¥ç›¸ä¹˜</strong></p>
<ul>
<li>2è¡Œ3åˆ— * 3è¡Œ2åˆ— = 2è¡Œ2åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰</li>
<li>3è¡Œ2åˆ— * 2è¡Œ3åˆ— = 3è¡Œ3åˆ— ï¼ˆå–ç¬¬ä¸€ä¸ªçŸ©é˜µçš„è¡Œå’Œç¬¬äºŒä¸ªçŸ©é˜µçš„åˆ—ï¼‰</li>
</ul>
<p>ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç½‘ç»œçš„è®¡ç®—æ¨¡å‹ï¼Œç”¨äºå¤„ç†å¤æ‚çš„æ¨¡å¼è¯†åˆ«é—®é¢˜ã€‚å®ƒä»¬ç”±ä¸€ç³»åˆ—<strong>ç¥ç»å…ƒ</strong>ï¼ˆæˆ–ç§°èŠ‚ç‚¹ï¼‰ç»„æˆï¼Œè¿™äº›ç¥ç»å…ƒé€šè¿‡<strong>æƒé‡</strong>ç›¸è¿ï¼Œæƒé‡æ˜¯ç¥ç»ç½‘ç»œä¸­æœ€é‡è¦çš„å‚æ•°ä¹‹ä¸€ã€‚æ¯ä¸ªç¥ç»å…ƒæ¥æ”¶è¾“å…¥ä¿¡å·ï¼Œå¹¶åº”ç”¨ä¸€ä¸ª<strong>æ¿€æ´»å‡½æ•°</strong>æ¥å†³å®šè¾“å‡ºä¿¡å·ã€‚</p>
<h4 id="å…³é”®æœ¯è¯­ï¼š">å…³é”®æœ¯è¯­ï¼š</h4>
<ol>
<li><strong>ç¥ç»å…ƒï¼ˆNeuronï¼‰</strong>ï¼šåŸºæœ¬çš„å¤„ç†å•å…ƒï¼Œæ¥æ”¶è¾“å…¥å¹¶ç”Ÿæˆè¾“å‡ºã€‚</li>
<li><strong>æƒé‡ï¼ˆWeightï¼‰</strong>ï¼šè¿æ¥ç¥ç»å…ƒä¹‹é—´çš„å‚æ•°ï¼Œå†³å®šä¿¡å·çš„å¼ºåº¦ã€‚</li>
<li><strong>åç½®ï¼ˆBiasï¼‰</strong>ï¼šä¸€ä¸ªç¥ç»å…ƒè¾“å‡ºä¸­ç‹¬ç«‹äºè¾“å…¥çš„é¡¹ï¼Œå¸®åŠ©è°ƒæ•´è¾“å‡ºã€‚</li>
<li><strong>æ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰</strong>ï¼šç”¨äºéçº¿æ€§è½¬æ¢ç¥ç»å…ƒçš„è¾“å‡ºï¼Œä¾‹å¦‚Sigmoid, Tanh, ReLUã€‚</li>
</ol>
<h4 id="ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œç»“æ„ï¼š">ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œç»“æ„ï¼š</h4>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">è¾“å…¥å±‚ï¼ˆ<span class="hljs-keyword">Input</span> Layerï¼‰ â†’ éšè—å±‚ï¼ˆHidden Layerï¼‰ â†’ è¾“å‡ºå±‚ï¼ˆ<span class="hljs-keyword">Output</span> Layerï¼‰<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>è¾“å…¥å±‚</strong>ï¼šæ¥æ”¶è¾“å…¥æ•°æ®ã€‚</li>
<li><strong>éšè—å±‚</strong>ï¼šä¸­é—´å±‚ï¼Œå¯ä»¥æœ‰å¤šå±‚ï¼Œç”¨äºæå–ç‰¹å¾ã€‚</li>
<li><strong>è¾“å‡ºå±‚</strong>ï¼šè¾“å‡ºæœ€ç»ˆçš„ç»“æœã€‚</li>
</ul>
<h3 id="ç»ƒä¹ ï¼š">ç»ƒä¹ ï¼š</h3>
<ol>
<li>
<p>è¯·ä½ ç®€å•æè¿°ç¥ç»ç½‘ç»œæ˜¯ä»€ä¹ˆã€‚</p>
</li>
<li>
<p>åˆ—å‡ºå¹¶è§£é‡Šç¥ç»ç½‘ç»œçš„ä¸‰ä¸ªä¸»è¦ç»„ä»¶ã€‚</p>
<p>ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç½‘ç»œçš„è®¡ç®—æ¨¡å‹ï¼Œç”¨äºå¤„ç†å¤æ‚çš„æ¨¡å¼è¯†åˆ«é—®é¢˜ï¼›ä¸‰ä¸ªä¸»è¦ç»„ä»¶æ˜¯è¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚</p>
</li>
</ol>
<h2 id="ç¬¬äºŒæ­¥ï¼šç†è§£ä¸€ä¸ªç®€å•ç¥ç»å…ƒçš„å·¥ä½œåŸç†">ç¬¬äºŒæ­¥ï¼šç†è§£ä¸€ä¸ªç®€å•ç¥ç»å…ƒçš„å·¥ä½œåŸç†</h2>
<p>ä¸€ä¸ªç¥ç»å…ƒæ¥æ”¶è¾“å…¥ã€è®¡ç®—åŠ æƒå’Œå¹¶åº”ç”¨æ¿€æ´»å‡½æ•°æ¥ç”Ÿæˆè¾“å‡ºã€‚è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°çœ‹ä¸€ä¸‹ä¸€ä¸ªç®€å•ç¥ç»å…ƒçš„å·¥ä½œè¿‡ç¨‹ï¼š</p>
<h4 id="ç¥ç»å…ƒçš„æ•°å­¦è¡¨è¾¾ï¼š">ç¥ç»å…ƒçš„æ•°å­¦è¡¨è¾¾ï¼š</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¾“å…¥ ( x )ï¼Œå®ƒç»è¿‡æƒé‡ ( w ) å’Œåç½® ( b ) è°ƒæ•´ï¼Œç„¶åé€šè¿‡æ¿€æ´»å‡½æ•° ( f ) æ¥ç”Ÿæˆè¾“å‡º ( y )ï¼š</p>
<p>$ y = f(w \cdot x + b) $</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>( x ) æ˜¯è¾“å…¥ã€‚</li>
<li>( w ) æ˜¯æƒé‡ã€‚</li>
<li>( b ) æ˜¯åç½®ã€‚</li>
<li>( f ) æ˜¯æ¿€æ´»å‡½æ•°ï¼ˆä¾‹å¦‚ï¼šSigmoidã€ReLU ç­‰ï¼‰ã€‚</li>
</ul>
<h4 id="å¸¸è§æ¿€æ´»å‡½æ•°ï¼š">å¸¸è§æ¿€æ´»å‡½æ•°ï¼š</h4>
<ol>
<li>
<p><strong>Sigmoid å‡½æ•°</strong>ï¼šå°†è¾“å…¥æ˜ å°„åˆ° (0) å’Œ (1) ä¹‹é—´ã€‚<br>
$ \sigma(x) = \frac{1}{1 + e^{-x}} $</p>
</li>
<li>
<p><strong>ReLU å‡½æ•°</strong>ï¼šå°†è´Ÿæ•°éƒ¨åˆ†æ˜ å°„ä¸º (0)ï¼Œæ­£æ•°éƒ¨åˆ†ä¸å˜ã€‚<br>
$ \text{ReLU}(x) = \max(0, x) $</p>
</li>
</ol>
<h4 id="ç»ƒä¹ ï¼š-v2">ç»ƒä¹ ï¼š</h4>
<ol>
<li>å‡è®¾ä½ æœ‰ä¸€ä¸ªè¾“å…¥ ( x = 2 )ï¼Œæƒé‡ ( w = 0.5 )ï¼Œåç½® ( b = 1 )ï¼Œå¹¶ä¸”ä½¿ç”¨ Sigmoid æ¿€æ´»å‡½æ•°ã€‚è®¡ç®—è¾“å‡º ( y )ã€‚</li>
<li>ä¸ºä»€ä¹ˆæ¿€æ´»å‡½æ•°æ˜¯å¿…è¦çš„ï¼Ÿ</li>
</ol>
<p>è¾“å…¥ x=2ï¼Œæƒé‡ w=0.5ï¼Œåç½® b=1ï¼Œè®¡ç®—è¾“å‡º yã€‚</p>
<p>è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>é¦–å…ˆï¼Œè®¡ç®—åŠ æƒå’ŒåŠåç½®ï¼š $wâ‹…x+b=0.5â‹…2+1=1+1=2$</li>
<li>ç„¶åï¼Œè®¡ç®— Sigmoid å‡½æ•°çš„å€¼ï¼š $\sigma(2) = \frac{1}{1 + e^{-2}} \approx 0.88$</li>
</ul>
<p>å› æ­¤ï¼Œè¾“å‡º$ yâ‰ˆ0.88$</p>
<h4 id="ä¸ºä»€ä¹ˆæ¿€æ´»å‡½æ•°æ˜¯å¿…è¦çš„ï¼Ÿ">ä¸ºä»€ä¹ˆæ¿€æ´»å‡½æ•°æ˜¯å¿…è¦çš„ï¼Ÿ</h4>
<p>æ¿€æ´»å‡½æ•°å¼•å…¥äº†éçº¿æ€§ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œè¡¨ç¤ºå¤æ‚çš„æ¨¡å¼ã€‚å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œç½‘ç»œåªä¼šè¿›è¡Œçº¿æ€§å˜æ¢ï¼ˆè¾“å…¥çš„åŠ æƒæ±‚å’Œï¼‰ï¼Œè¿™æ— æ³•æœ‰æ•ˆåœ°å¤„ç†å¤æ‚çš„æ¨¡å¼æˆ–å†³ç­–é—®é¢˜ã€‚</p>
<h2 id="ç¬¬ä¸‰æ­¥ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»å…ƒ">ç¬¬ä¸‰æ­¥ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»å…ƒ</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠåˆšæ‰å­¦åˆ°çš„çŸ¥è¯†åº”ç”¨äºæ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»å…ƒï¼Œå¹¶ç”¨ Python ä»£ç æ¥å®ç°å®ƒã€‚</p>
<h4 id="æ„å»ºæ­¥éª¤ï¼š">æ„å»ºæ­¥éª¤ï¼š</h4>
<ol>
<li><strong>å®šä¹‰ç¥ç»å…ƒçš„ç»“æ„</strong>ï¼šåŒ…æ‹¬è¾“å…¥ã€æƒé‡ã€åç½®å’Œæ¿€æ´»å‡½æ•°ã€‚</li>
<li><strong>å®ç°åŠ æƒå’ŒåŠåç½®</strong>ï¼šè®¡ç®— $( w \cdot x + b )$ã€‚</li>
<li><strong>åº”ç”¨æ¿€æ´»å‡½æ•°</strong>ï¼šä½¿ç”¨ Sigmoid å‡½æ•°æ¥è®¡ç®—è¾“å‡ºã€‚</li>
</ol>
<h3 id="Python-ä»£ç å®ç°">Python ä»£ç å®ç°</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•ç¥ç»å…ƒçš„ Python å®ç°ï¼ŒåŒ…æ‹¬è¾“å…¥ã€æƒé‡ã€åç½®å’Œ Sigmoid æ¿€æ´»å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><br><span class="hljs-comment"># å®šä¹‰ Sigmoid æ¿€æ´»å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + math.exp(-x))<br><br><span class="hljs-comment"># è¾“å…¥ã€æƒé‡å’Œåç½®</span><br>x = <span class="hljs-number">2</span>            <span class="hljs-comment"># è¾“å…¥</span><br>w = <span class="hljs-number">0.5</span>          <span class="hljs-comment"># æƒé‡</span><br>b = <span class="hljs-number">1</span>            <span class="hljs-comment"># åç½®</span><br><br><span class="hljs-comment"># è®¡ç®—åŠ æƒå’ŒåŠåç½®</span><br>z = w * x + b<br><br><span class="hljs-comment"># åº”ç”¨ Sigmoid æ¿€æ´»å‡½æ•°</span><br>y = sigmoid(z)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¾“å‡º y = <span class="hljs-subst">&#123;y&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h4 id="ä»£ç è§£é‡Šï¼š">ä»£ç è§£é‡Šï¼š</h4>
<ol>
<li>å®šä¹‰äº†ä¸€ä¸ª <code>sigmoid</code> å‡½æ•°æ¥è®¡ç®— Sigmoid æ¿€æ´»å‡½æ•°çš„å€¼ã€‚</li>
<li>è®¾ç½®äº†è¾“å…¥ ( x )ã€æƒé‡ ( w ) å’Œåç½® ( b )ã€‚</li>
<li>è®¡ç®—äº†åŠ æƒå’ŒåŠåç½® ( z )ã€‚</li>
<li>ä½¿ç”¨ <code>sigmoid</code> å‡½æ•°è®¡ç®—è¾“å‡º ( y )ã€‚</li>
<li>æ‰“å°è¾“å‡ºç»“æœã€‚</li>
</ol>
<h3 id="ç»ƒä¹ ï¼š-v3">ç»ƒä¹ ï¼š</h3>
<ol>
<li>è¯·åœ¨ä½ çš„ Python ç¯å¢ƒä¸­è¿è¡Œä¸Šè¿°ä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºã€‚</li>
<li>å°è¯•ä¿®æ”¹è¾“å…¥ ( x )ã€æƒé‡ ( w ) å’Œåç½® ( b ) çš„å€¼ï¼Œè§‚å¯Ÿè¾“å‡ºæ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚</li>
</ol>
<h2 id="ç¬¬å››æ­¥ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œ">ç¬¬å››æ­¥ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œ</h2>
<p>æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåŒ…å«è¾“å…¥å±‚ã€ä¸€ä¸ªéšè—å±‚å’Œè¾“å‡ºå±‚çš„ç®€å•ç¥ç»ç½‘ç»œã€‚è¿™ä¸ªç¥ç»ç½‘ç»œå°†æ¥å—ä¸¤ä¸ªè¾“å…¥ï¼Œç»è¿‡ä¸€ä¸ªéšè—å±‚å¤„ç†åï¼Œç”Ÿæˆä¸€ä¸ªè¾“å‡ºã€‚</p>
<h4 id="ç¥ç»ç½‘ç»œç»“æ„ï¼š">ç¥ç»ç½‘ç»œç»“æ„ï¼š</h4>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">è¾“å…¥å±‚ <span class="hljs-comment">(2 ä¸ªè¾“å…¥)</span> â†’ éšè—å±‚ <span class="hljs-comment">(2 ä¸ªç¥ç»å…ƒ)</span> â†’ è¾“å‡ºå±‚ <span class="hljs-comment">(1 ä¸ªè¾“å‡º)</span><br></code></pre></td></tr></table></figure>
<h3 id="å…·ä½“æ­¥éª¤ï¼š">å…·ä½“æ­¥éª¤ï¼š</h3>
<ol>
<li><strong>åˆå§‹åŒ–è¾“å…¥ã€æƒé‡å’Œåç½®</strong>ã€‚</li>
<li><strong>è®¡ç®—éšè—å±‚çš„è¾“å‡º</strong>ã€‚</li>
<li><strong>è®¡ç®—è¾“å‡ºå±‚çš„è¾“å‡º</strong>ã€‚</li>
</ol>
<h3 id="Python-ä»£ç å®ç°-v2">Python ä»£ç å®ç°</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•æ„å»ºå’Œè¿è¡Œè¿™ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># å®šä¹‰ Sigmoid æ¿€æ´»å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-comment"># è¾“å…¥</span><br>inputs = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])  <span class="hljs-comment"># 2 ä¸ªè¾“å…¥</span><br><br><span class="hljs-comment"># æƒé‡å’Œåç½®</span><br><span class="hljs-comment"># éšè—å±‚ (2 ä¸ªç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒæœ‰ 2 ä¸ªè¾“å…¥)</span><br>hidden_weights = np.array([[<span class="hljs-number">0.5</span>, -<span class="hljs-number">0.6</span>], <br>                           [<span class="hljs-number">0.1</span>, <span class="hljs-number">0.8</span>]])  <span class="hljs-comment"># æƒé‡çŸ©é˜µ 2x2</span><br>hidden_bias = np.array([<span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>])      <span class="hljs-comment"># åç½®å‘é‡</span><br><br><span class="hljs-comment"># è¾“å‡ºå±‚ (1 ä¸ªç¥ç»å…ƒï¼Œ2 ä¸ªè¾“å…¥)</span><br>output_weights = np.array([<span class="hljs-number">0.4</span>, -<span class="hljs-number">0.7</span>])  <span class="hljs-comment"># æƒé‡å‘é‡</span><br>output_bias = <span class="hljs-number">0.1</span>                       <span class="hljs-comment"># åç½®</span><br><br><span class="hljs-comment"># è®¡ç®—éšè—å±‚çš„è¾“å‡º</span><br>hidden_input = np.dot(hidden_weights, inputs) + hidden_bias<br>hidden_output = sigmoid(hidden_input)<br><br><span class="hljs-comment"># è®¡ç®—è¾“å‡ºå±‚çš„è¾“å‡º</span><br>output_input = np.dot(output_weights, hidden_output) + output_bias<br>output = sigmoid(output_input)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;éšè—å±‚è¾“å‡º: <span class="hljs-subst">&#123;hidden_output&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æœ€ç»ˆè¾“å‡º: <span class="hljs-subst">&#123;output&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h4 id="ä»£ç è§£é‡Šï¼š-v2">ä»£ç è§£é‡Šï¼š</h4>
<ol>
<li><strong>å®šä¹‰ Sigmoid æ¿€æ´»å‡½æ•°</strong>ï¼šä½¿ç”¨ <code>numpy</code> çš„ <code>exp</code> å‡½æ•°å¤„ç†æ•°ç»„ã€‚</li>
<li><strong>åˆå§‹åŒ–è¾“å…¥</strong>ï¼š<code>inputs</code> æ˜¯ä¸€ä¸ªåŒ…å« 2 ä¸ªè¾“å…¥çš„æ•°ç»„ã€‚</li>
<li><strong>åˆå§‹åŒ–éšè—å±‚çš„æƒé‡å’Œåç½®</strong>ï¼š<code>hidden_weights</code> æ˜¯ 2x2 çš„æƒé‡çŸ©é˜µï¼Œ<code>hidden_bias</code> æ˜¯åŒ…å« 2 ä¸ªåç½®çš„æ•°ç»„ã€‚</li>
<li><strong>åˆå§‹åŒ–è¾“å‡ºå±‚çš„æƒé‡å’Œåç½®</strong>ï¼š<code>output_weights</code> æ˜¯ 1x2 çš„æƒé‡å‘é‡ï¼Œ<code>output_bias</code> æ˜¯ä¸€ä¸ªå•ä¸€çš„åç½®å€¼ã€‚</li>
<li><strong>è®¡ç®—éšè—å±‚çš„è¾“å‡º</strong>ï¼šä½¿ç”¨ <code>np.dot</code> è®¡ç®—æƒé‡å’Œè¾“å…¥çš„ç‚¹ç§¯ï¼ŒåŠ ä¸Šåç½®ï¼Œå†é€šè¿‡ <code>sigmoid</code> å‡½æ•°å¤„ç†ã€‚</li>
<li><strong>è®¡ç®—è¾“å‡ºå±‚çš„è¾“å‡º</strong>ï¼šç±»ä¼¼åœ°ï¼Œä½¿ç”¨éšè—å±‚çš„è¾“å‡ºè®¡ç®—è¾“å‡ºå±‚çš„æœ€ç»ˆè¾“å‡ºã€‚</li>
</ol>
<h3 id="ç»ƒä¹ ï¼š-v4">ç»ƒä¹ ï¼š</h3>
<ol>
<li>è¯·åœ¨ä½ çš„ Python ç¯å¢ƒä¸­è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¹¶è§‚å¯Ÿè¾“å‡ºç»“æœã€‚</li>
<li>å°è¯•ä¿®æ”¹è¾“å…¥ã€éšè—å±‚å’Œè¾“å‡ºå±‚çš„æƒé‡å’Œåç½®ï¼Œè§‚å¯Ÿè¾“å‡ºæ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚</li>
</ol>
<h2 id="ç¬¬äº”æ­¥ï¼šç†è§£ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹">ç¬¬äº”æ­¥ï¼šç†è§£ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹</h2>
<p>ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µï¼š<strong>å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</strong> å’Œ <strong>åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰</strong>ã€‚æˆ‘ä»¬æ¥é€æ­¥ç†è§£è¿™ä¸¤ä¸ªè¿‡ç¨‹ã€‚</p>
<h4 id="1-å‰å‘ä¼ æ’­ï¼ˆForward-Propagationï¼‰">1. å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</h4>
<p>å‰å‘ä¼ æ’­æ˜¯å°†è¾“å…¥æ•°æ®é€šè¿‡ç¥ç»ç½‘ç»œï¼Œè®¡ç®—å‡ºé¢„æµ‹çš„è¾“å‡ºã€‚</p>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>è¾“å…¥æ•°æ®é€šè¿‡è¾“å…¥å±‚ä¼ é€’åˆ°éšè—å±‚ã€‚</li>
<li>éšè—å±‚çš„è¾“å‡ºä¼ é€’åˆ°è¾“å‡ºå±‚ã€‚</li>
<li>è¾“å‡ºå±‚ç”Ÿæˆæœ€ç»ˆçš„é¢„æµ‹è¾“å‡ºã€‚</li>
</ol>
<h4 id="2-æŸå¤±å‡½æ•°ï¼ˆLoss-Functionï¼‰">2. æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰</h4>
<p>æŸå¤±å‡½æ•°ç”¨äºè¡¡é‡é¢„æµ‹è¾“å‡ºä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·ã€‚ä¸€ä¸ªå¸¸è§çš„æŸå¤±å‡½æ•°æ˜¯<strong>å‡æ–¹è¯¯å·®ï¼ˆMean Squared Error, MSEï¼‰</strong>ï¼š</p>
<p>$\text{MSE} = \frac{1}{N} \sum_{i=1}^N (\hat{y_i} - y_i)^2 $</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>$ N  $æ˜¯æ ·æœ¬æ•°é‡ã€‚</li>
<li>$\hat{y_i} $æ˜¯é¢„æµ‹å€¼ã€‚</li>
<li>$y_i$ æ˜¯çœŸå®å€¼ã€‚</li>
</ul>
<h4 id="3-åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰">3. åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰</h4>
<p>åå‘ä¼ æ’­ç”¨äºè°ƒæ•´ç¥ç»ç½‘ç»œä¸­çš„æƒé‡å’Œåç½®ï¼Œä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°çš„å€¼ã€‚å®ƒåŸºäºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œé€šè¿‡è®¡ç®—æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¯ä¸ªæƒé‡å’Œåç½®çš„åå¯¼æ•°æ¥æ›´æ–°å®ƒä»¬ã€‚</p>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€‚</li>
<li>åå‘ä¼ æ’­è¿™äº›æ¢¯åº¦ï¼Œé€šè¿‡é“¾å¼æ³•åˆ™è°ƒæ•´æ¯ä¸€å±‚çš„æƒé‡å’Œåç½®ã€‚</li>
</ol>
<h3 id="Python-ä»£ç å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰">Python ä»£ç å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰</h3>
<p>æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ï¼Œä½¿ç”¨ä¸€ä¸ªè¾“å…¥æ ·æœ¬è¿›è¡Œè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># å®šä¹‰æ¿€æ´»å‡½æ•°åŠå…¶å¯¼æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid_derivative</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x * (<span class="hljs-number">1</span> - x)<br><br><span class="hljs-comment"># è¾“å…¥æ•°æ®å’ŒçœŸå®è¾“å‡º</span><br>inputs = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])<br>true_output = np.array([<span class="hljs-number">0.8</span>])<br><br><span class="hljs-comment"># åˆå§‹åŒ–æƒé‡å’Œåç½®</span><br>hidden_weights = np.array([[<span class="hljs-number">0.5</span>, -<span class="hljs-number">0.6</span>], <br>                           [<span class="hljs-number">0.1</span>, <span class="hljs-number">0.8</span>]])<br>hidden_bias = np.array([<span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>])<br><br>output_weights = np.array([[<span class="hljs-number">0.4</span>, -<span class="hljs-number">0.7</span>]])<br>output_bias = <span class="hljs-number">0.1</span><br><br><span class="hljs-comment"># å­¦ä¹ ç‡</span><br>learning_rate = <span class="hljs-number">0.5</span><br><br><span class="hljs-comment"># å‰å‘ä¼ æ’­</span><br>hidden_input = np.dot(hidden_weights, inputs) + hidden_bias<br>hidden_output = sigmoid(hidden_input)<br><br>output_input = np.dot(output_weights, hidden_output) + output_bias<br>predicted_output = sigmoid(output_input)<br><br><span class="hljs-comment"># è®¡ç®—æŸå¤±ï¼ˆå‡æ–¹è¯¯å·®ï¼‰</span><br>loss = np.mean((true_output - predicted_output) ** <span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># åå‘ä¼ æ’­</span><br><span class="hljs-comment"># è¾“å‡ºå±‚è¯¯å·®</span><br>output_error = true_output - predicted_output<br>output_delta = output_error * sigmoid_derivative(predicted_output)<br><br><span class="hljs-comment"># éšè—å±‚è¯¯å·®</span><br>hidden_error = output_delta.dot(output_weights)<br>hidden_delta = hidden_error * sigmoid_derivative(hidden_output)<br><br><span class="hljs-comment"># æ›´æ–°æƒé‡å’Œåç½®</span><br>output_weights += learning_rate * output_delta * hidden_output<br>output_bias += learning_rate * output_delta<br><br>hidden_weights += learning_rate * np.outer(hidden_delta, inputs)<br>hidden_bias += learning_rate * hidden_delta<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹è¾“å‡º: <span class="hljs-subst">&#123;predicted_output&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æŸå¤±: <span class="hljs-subst">&#123;loss&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ›´æ–°åçš„æƒé‡å’Œåç½®: <span class="hljs-subst">&#123;output_weights&#125;</span>, <span class="hljs-subst">&#123;output_bias&#125;</span>, <span class="hljs-subst">&#123;hidden_weights&#125;</span>, <span class="hljs-subst">&#123;hidden_bias&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h4 id="ä»£ç è§£é‡Šï¼š-v3">ä»£ç è§£é‡Šï¼š</h4>
<ol>
<li><strong>å®šä¹‰æ¿€æ´»å‡½æ•°åŠå…¶å¯¼æ•°</strong>ï¼š<code>sigmoid</code> åŠ <code>sigmoid_derivative</code>ã€‚</li>
<li><strong>åˆå§‹åŒ–è¾“å…¥å’ŒçœŸå®è¾“å‡º</strong>ï¼š<code>inputs</code> å’Œ <code>true_output</code>ã€‚</li>
<li><strong>åˆå§‹åŒ–æƒé‡å’Œåç½®</strong>ï¼š<code>hidden_weights</code>ã€<code>hidden_bias</code>ã€<code>output_weights</code> å’Œ <code>output_bias</code>ã€‚</li>
<li><strong>è®¾ç½®å­¦ä¹ ç‡</strong>ã€‚</li>
<li><strong>å‰å‘ä¼ æ’­</strong>ï¼šè®¡ç®—éšè—å±‚å’Œè¾“å‡ºå±‚çš„è¾“å‡ºã€‚</li>
<li><strong>è®¡ç®—æŸå¤±</strong>ï¼šä½¿ç”¨å‡æ–¹è¯¯å·®ã€‚</li>
<li><strong>åå‘ä¼ æ’­</strong>ï¼šè®¡ç®—è¾“å‡ºå±‚å’Œéšè—å±‚çš„è¯¯å·®åŠæ›´æ–°é‡ã€‚</li>
<li><strong>æ›´æ–°æƒé‡å’Œåç½®</strong>ã€‚</li>
</ol>
<h3 id="ç»ƒä¹ ï¼š-v5">ç»ƒä¹ ï¼š</h3>
<ol>
<li>åœ¨ä½ çš„ Python ç¯å¢ƒä¸­è¿è¡Œä¸Šè¿°ä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºå’Œæƒé‡æ›´æ–°ã€‚</li>
<li>å°è¯•ä¿®æ”¹è¾“å…¥ã€çœŸå®è¾“å‡ºã€æƒé‡å’Œåç½®çš„åˆå§‹å€¼ï¼Œè§‚å¯Ÿè®­ç»ƒè¿‡ç¨‹ä¸­çš„å˜åŒ–ã€‚</li>
</ol>
<h2 id="ç¬¬å…­æ­¥ï¼šæ‰©å±•ç¥ç»ç½‘ç»œ">ç¬¬å…­æ­¥ï¼šæ‰©å±•ç¥ç»ç½‘ç»œ</h2>
<p>æˆ‘ä»¬å°†æ‰©å±•ç¥ç»ç½‘ç»œï¼Œå¢åŠ æ›´å¤šçš„éšè—å±‚å’Œç¥ç»å…ƒï¼Œä»¥å¤„ç†æ›´å¤æ‚çš„æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ‰¹é‡æ¢¯åº¦ä¸‹é™å’Œå…¶ä»–ä¼˜åŒ–æŠ€å·§ã€‚</p>
<h4 id="æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆBatch-Gradient-Descentï¼‰">æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descentï¼‰</h4>
<p>æ‰¹é‡æ¢¯åº¦ä¸‹é™æ˜¯è®­ç»ƒç¥ç»ç½‘ç»œçš„ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼Œå®ƒåœ¨æ•´ä¸ªè®­ç»ƒæ•°æ®é›†ä¸Šè®¡ç®—æŸå¤±å¹¶æ›´æ–°æƒé‡ã€‚è¿™ç§æ–¹æ³•æœ‰åŠ©äºç¨³å®šè®­ç»ƒè¿‡ç¨‹ã€‚</p>
<h4 id="æ‰©å±•ç½‘ç»œçš„æ­¥éª¤ï¼š">æ‰©å±•ç½‘ç»œçš„æ­¥éª¤ï¼š</h4>
<ol>
<li><strong>å¢åŠ æ›´å¤šçš„éšè—å±‚</strong>ï¼šå¯ä»¥é€šè¿‡å¢åŠ æ›´å¤šçš„éšè—å±‚å’Œç¥ç»å…ƒæ¥æé«˜ç½‘ç»œçš„è¡¨ç°åŠ›ã€‚</li>
<li><strong>å¼•å…¥æ›´å¤šæ¿€æ´»å‡½æ•°</strong>ï¼šæ¯”å¦‚ ReLUï¼Œå¯ä»¥å¤„ç†æ›´å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚</li>
<li><strong>ä½¿ç”¨æ‰¹é‡æ¢¯åº¦ä¸‹é™</strong>ï¼šåœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šè®¡ç®—æŸå¤±å¹¶æ›´æ–°æƒé‡ã€‚</li>
</ol>
<h3 id="Python-ä»£ç å®ç°ï¼ˆæ‰©å±•ç‰ˆï¼‰">Python ä»£ç å®ç°ï¼ˆæ‰©å±•ç‰ˆï¼‰</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†ä¸€ä¸ªåŒ…å«æ›´å¤šéšè—å±‚çš„ç¥ç»ç½‘ç»œï¼Œå¹¶ä½¿ç”¨æ‰¹é‡æ¢¯åº¦ä¸‹é™æ¥è®­ç»ƒï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># å®šä¹‰æ¿€æ´»å‡½æ•°åŠå…¶å¯¼æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid_derivative</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x * (<span class="hljs-number">1</span> - x)<br><br><span class="hljs-comment"># æ•°æ®é›†ï¼ˆç®€å•ç¤ºä¾‹ï¼‰</span><br>inputs = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">0.5</span>, <span class="hljs-number">0.3</span>], [<span class="hljs-number">0.2</span>, <span class="hljs-number">0.8</span>]])<br>true_outputs = np.array([[<span class="hljs-number">0.8</span>], [<span class="hljs-number">0.4</span>], [<span class="hljs-number">0.6</span>]])<br><br><span class="hljs-comment"># åˆå§‹åŒ–æƒé‡å’Œåç½®</span><br>input_size = <span class="hljs-number">2</span><br>hidden_size1 = <span class="hljs-number">3</span><br>hidden_size2 = <span class="hljs-number">2</span><br>output_size = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># éšè—å±‚ 1</span><br>hidden_weights1 = np.random.rand(hidden_size1, input_size)<br>hidden_bias1 = np.random.rand(hidden_size1)<br><br><span class="hljs-comment"># éšè—å±‚ 2</span><br>hidden_weights2 = np.random.rand(hidden_size2, hidden_size1)<br>hidden_bias2 = np.random.rand(hidden_size2)<br><br><span class="hljs-comment"># è¾“å‡ºå±‚</span><br>output_weights = np.random.rand(output_size, hidden_size2)<br>output_bias = np.random.rand(output_size)<br><br><span class="hljs-comment"># å­¦ä¹ ç‡</span><br>learning_rate = <span class="hljs-number">0.5</span><br><br><span class="hljs-comment"># è®­ç»ƒè¿‡ç¨‹</span><br>epochs = <span class="hljs-number">10000</span><br><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):<br>    <span class="hljs-comment"># å‰å‘ä¼ æ’­</span><br>    hidden_input1 = np.dot(inputs, hidden_weights1.T) + hidden_bias1<br>    hidden_output1 = sigmoid(hidden_input1)<br><br>    hidden_input2 = np.dot(hidden_output1, hidden_weights2.T) + hidden_bias2<br>    hidden_output2 = sigmoid(hidden_input2)<br><br>    output_input = np.dot(hidden_output2, output_weights.T) + output_bias<br>    predicted_output = sigmoid(output_input)<br><br>    <span class="hljs-comment"># è®¡ç®—æŸå¤±</span><br>    loss = np.mean((true_outputs - predicted_output) ** <span class="hljs-number">2</span>)<br><br>    <span class="hljs-comment"># åå‘ä¼ æ’­</span><br>    <span class="hljs-comment"># è¾“å‡ºå±‚è¯¯å·®</span><br>    output_error = true_outputs - predicted_output<br>    output_delta = output_error * sigmoid_derivative(predicted_output)<br><br>    <span class="hljs-comment"># éšè—å±‚ 2 è¯¯å·®</span><br>    hidden_error2 = np.dot(output_delta, output_weights)<br>    hidden_delta2 = hidden_error2 * sigmoid_derivative(hidden_output2)<br><br>    <span class="hljs-comment"># éšè—å±‚ 1 è¯¯å·®</span><br>    hidden_error1 = np.dot(hidden_delta2, hidden_weights2)<br>    hidden_delta1 = hidden_error1 * sigmoid_derivative(hidden_output1)<br><br>    <span class="hljs-comment"># æ›´æ–°æƒé‡å’Œåç½®</span><br>    output_weights += learning_rate * np.dot(output_delta.T, hidden_output2)<br>    output_bias += learning_rate * np.mean(output_delta, axis=<span class="hljs-number">0</span>)<br><br>    hidden_weights2 += learning_rate * np.dot(hidden_delta2.T, hidden_output1)<br>    hidden_bias2 += learning_rate * np.mean(hidden_delta2, axis=<span class="hljs-number">0</span>)<br><br>    hidden_weights1 += learning_rate * np.dot(hidden_delta1.T, inputs)<br>    hidden_bias1 += learning_rate * np.mean(hidden_delta1, axis=<span class="hljs-number">0</span>)<br><br>    <span class="hljs-comment"># æ‰“å°æŸå¤±</span><br>    <span class="hljs-keyword">if</span> epoch % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">&#123;epoch&#125;</span>, Loss: <span class="hljs-subst">&#123;loss&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># æœ€ç»ˆé¢„æµ‹è¾“å‡º</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æœ€ç»ˆé¢„æµ‹è¾“å‡º: <span class="hljs-subst">&#123;predicted_output&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h4 id="ä»£ç è§£é‡Šï¼š-v4">ä»£ç è§£é‡Šï¼š</h4>
<ol>
<li><strong>æ‰©å±•æ•°æ®é›†</strong>ï¼šä½¿ç”¨å¤šä¸ªæ ·æœ¬ã€‚</li>
<li><strong>å¢åŠ éšè—å±‚</strong>ï¼šå¢åŠ ä¸€ä¸ªé¢å¤–çš„éšè—å±‚ <code>hidden_layer2</code>ã€‚</li>
<li><strong>æ‰¹é‡æ¢¯åº¦ä¸‹é™</strong>ï¼šåœ¨æ¯ä¸ª epoch ä¸­æ›´æ–°æƒé‡å’Œåç½®ã€‚</li>
<li><strong>è¾“å‡ºé¢„æµ‹ç»“æœ</strong>ï¼šæ‰“å°æŸå¤±å¹¶æ˜¾ç¤ºæœ€ç»ˆé¢„æµ‹è¾“å‡ºã€‚</li>
</ol>
<h3 id="ç»ƒä¹ ï¼š-v6">ç»ƒä¹ ï¼š</h3>
<ol>
<li>è¯·åœ¨ä½ çš„ Python ç¯å¢ƒä¸­è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¹¶è§‚å¯Ÿè¾“å‡ºç»“æœã€‚</li>
<li>å°è¯•è°ƒæ•´ç½‘ç»œç»“æ„ï¼ˆå¦‚å¢åŠ ç¥ç»å…ƒæ•°é‡æˆ–éšè—å±‚ï¼‰ï¼Œè§‚å¯Ÿå¯¹è®­ç»ƒè¿‡ç¨‹çš„å½±å“ã€‚</li>
<li>äº†è§£æ‰¹é‡å¤§å°ï¼ˆbatch sizeï¼‰å’Œ epoch æ•°å¯¹è®­ç»ƒçš„å½±å“ã€‚</li>
</ol>
<h3 id="å¸¸è§é—®é¢˜ï¼š">å¸¸è§é—®é¢˜ï¼š</h3>
<ol>
<li>
<p><strong>å¦‚ä½•é¿å…è¿‡æ‹Ÿåˆï¼Ÿ</strong></p>
<ul>
<li>ä½¿ç”¨æ­£åˆ™åŒ–æŠ€æœ¯ï¼ˆå¦‚ L2 æ­£åˆ™åŒ–ï¼‰ã€‚</li>
<li>ä½¿ç”¨ Dropout æŠ€æœ¯ã€‚</li>
<li>å¢åŠ æ•°æ®é›†ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¦‚ä½•é€‰æ‹©å­¦ä¹ ç‡ï¼Ÿ</strong></p>
<ul>
<li>å­¦ä¹ ç‡è¿‡é«˜ä¼šå¯¼è‡´è®­ç»ƒä¸ç¨³å®šï¼Œè¿‡ä½ä¼šå¯¼è‡´è®­ç»ƒè¿‡æ…¢ã€‚å¯ä»¥ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨é€æ­¥è°ƒæ•´ã€‚</li>
</ul>
</li>
</ol>
<h3 id="True-Outputs-è¶…è¿‡-1-çš„æƒ…å†µ">True Outputs è¶…è¿‡ 1 çš„æƒ…å†µ</h3>
<h4 id="1-ä½¿ç”¨-Sigmoid-ä½œä¸ºè¾“å‡ºå±‚æ¿€æ´»å‡½æ•°">1. ä½¿ç”¨ Sigmoid ä½œä¸ºè¾“å‡ºå±‚æ¿€æ´»å‡½æ•°</h4>
<p><strong>Sigmoid å‡½æ•°</strong>çš„è¾“å‡ºèŒƒå›´æ˜¯ 0 åˆ° 1ã€‚å¦‚æœ <code>true_outputs</code> è¶…è¿‡ 1ï¼Œä¼šå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>ä¸åŒ¹é…çš„è¾“å‡ºèŒƒå›´</strong>ï¼šSigmoid å‡½æ•°çš„è¾“å‡ºæ°¸è¿œä¸ä¼šè¶…è¿‡ 1ï¼Œå› æ­¤ <code>true_outputs</code> è¶…è¿‡ 1 ä¼šå¯¼è‡´è¾ƒå¤§çš„è¯¯å·®ï¼Œå¯èƒ½å½±å“è®­ç»ƒæ•ˆæœã€‚</li>
<li><strong>æŸå¤±å‡½æ•°è®¡ç®—é—®é¢˜</strong>ï¼šå¦‚æœä½¿ç”¨å‡æ–¹è¯¯å·® (MSE) ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œè¿‡å¤§çš„è¯¯å·®ä¼šå¯¼è‡´æ¢¯åº¦è¿‡å¤§ï¼Œå¯èƒ½ä½¿è®­ç»ƒä¸ç¨³å®šã€‚</li>
</ul>
<h4 id="è§£å†³æ–¹æ³•ï¼š">è§£å†³æ–¹æ³•ï¼š</h4>
<ul>
<li><strong>å½’ä¸€åŒ–è¾“å‡º</strong>ï¼šå°† <code>true_outputs</code> å½’ä¸€åŒ–åˆ° 0 åˆ° 1 èŒƒå›´å†…ï¼Œä½¿ä¹‹ä¸ Sigmoid å‡½æ•°çš„è¾“å‡ºåŒ¹é…ã€‚</li>
<li><strong>ä½¿ç”¨ä¸åŒçš„æ¿€æ´»å‡½æ•°</strong>ï¼šå¦‚æœè¾“å‡ºä¸åº”è¯¥è¢«é™åˆ¶åœ¨ 0 åˆ° 1 èŒƒå›´ï¼Œå¯ä»¥è€ƒè™‘å…¶ä»–æ¿€æ´»å‡½æ•°ï¼Œå¦‚çº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå³æ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼‰ã€‚</li>
</ul>
<h3 id="ä¿®æ”¹ä»£ç ä»¥å¤„ç†-True-Outputs-è¶…è¿‡-1">ä¿®æ”¹ä»£ç ä»¥å¤„ç† True Outputs è¶…è¿‡ 1</h3>
<h4 id="æ–¹æ³•-1ï¼šå½’ä¸€åŒ–-True-Outputs">æ–¹æ³• 1ï¼šå½’ä¸€åŒ– True Outputs</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å‡è®¾ä½ çš„ true_outputs åŸå§‹èŒƒå›´æ˜¯ 0 åˆ° 10</span><br>true_outputs = np.array([[<span class="hljs-number">8</span>], [<span class="hljs-number">4</span>], [<span class="hljs-number">6</span>]])<br><br><span class="hljs-comment"># å½’ä¸€åŒ– true_outputs åˆ° 0 åˆ° 1</span><br>true_outputs = true_outputs / <span class="hljs-number">10.0</span><br></code></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•-2ï¼šä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°">æ–¹æ³• 2ï¼šä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># çº¿æ€§æ¿€æ´»å‡½æ•°åŠå…¶å¯¼æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">linear</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">linear_derivative</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br><span class="hljs-comment"># ä¿®æ”¹ä»£ç ä¸­ sigmoid å‡½æ•°éƒ¨åˆ†ä¸ºçº¿æ€§å‡½æ•°</span><br>hidden_output2 = sigmoid(hidden_input2)  <span class="hljs-comment"># éšè—å±‚ä»ç„¶ä½¿ç”¨ Sigmoid</span><br>output_input = np.dot(hidden_output2, output_weights.T) + output_bias<br>predicted_output = linear(output_input)  <span class="hljs-comment"># è¾“å‡ºå±‚ä½¿ç”¨çº¿æ€§å‡½æ•°</span><br><br><span class="hljs-comment"># åå‘ä¼ æ’­</span><br>output_error = true_outputs - predicted_output<br>output_delta = output_error * linear_derivative(predicted_output)<br></code></pre></td></tr></table></figure>
<h3 id="ç¤ºä¾‹ä»£ç ï¼šä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°çš„å®Œæ•´ç¤ºä¾‹">ç¤ºä¾‹ä»£ç ï¼šä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°çš„å®Œæ•´ç¤ºä¾‹</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># å®šä¹‰æ¿€æ´»å‡½æ•°åŠå…¶å¯¼æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid_derivative</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x * (<span class="hljs-number">1</span> - x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">linear</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">linear_derivative</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br><span class="hljs-comment"># æ•°æ®é›†ï¼ˆç®€å•ç¤ºä¾‹ï¼‰</span><br>inputs = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">0.5</span>, <span class="hljs-number">0.3</span>], [<span class="hljs-number">0.2</span>, <span class="hljs-number">0.8</span>]])<br>true_outputs = np.array([[<span class="hljs-number">8</span>], [<span class="hljs-number">4</span>], [<span class="hljs-number">6</span>]])<br><br><span class="hljs-comment"># åˆå§‹åŒ–æƒé‡å’Œåç½®</span><br>input_size = <span class="hljs-number">2</span><br>hidden_size1 = <span class="hljs-number">3</span><br>hidden_size2 = <span class="hljs-number">2</span><br>output_size = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># éšè—å±‚ 1</span><br>hidden_weights1 = np.random.rand(hidden_size1, input_size)<br>hidden_bias1 = np.random.rand(hidden_size1)<br><br><span class="hljs-comment"># éšè—å±‚ 2</span><br>hidden_weights2 = np.random.rand(hidden_size2, hidden_size1)<br>hidden_bias2 = np.random.rand(hidden_size2)<br><br><span class="hljs-comment"># è¾“å‡ºå±‚</span><br>output_weights = np.random.rand(output_size, hidden_size2)<br>output_bias = np.random.rand(output_size)<br><br><span class="hljs-comment"># å­¦ä¹ ç‡</span><br>learning_rate = <span class="hljs-number">0.5</span><br><br><span class="hljs-comment"># è®­ç»ƒè¿‡ç¨‹</span><br>epochs = <span class="hljs-number">10000</span><br><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):<br>    <span class="hljs-comment"># å‰å‘ä¼ æ’­</span><br>    hidden_input1 = np.dot(inputs, hidden_weights1.T) + hidden_bias1<br>    hidden_output1 = sigmoid(hidden_input1)<br><br>    hidden_input2 = np.dot(hidden_output1, hidden_weights2.T) + hidden_bias2<br>    hidden_output2 = sigmoid(hidden_input2)<br><br>    output_input = np.dot(hidden_output2, output_weights.T) + output_bias<br>    predicted_output = linear(output_input)  <span class="hljs-comment"># è¾“å‡ºå±‚ä½¿ç”¨çº¿æ€§å‡½æ•°</span><br><br>    <span class="hljs-comment"># è®¡ç®—æŸå¤±</span><br>    loss = np.mean((true_outputs - predicted_output) ** <span class="hljs-number">2</span>)<br><br>    <span class="hljs-comment"># åå‘ä¼ æ’­</span><br>    <span class="hljs-comment"># è¾“å‡ºå±‚è¯¯å·®</span><br>    output_error = true_outputs - predicted_output<br>    output_delta = output_error * linear_derivative(predicted_output)<br><br>    <span class="hljs-comment"># éšè—å±‚ 2 è¯¯å·®</span><br>    hidden_error2 = np.dot(output_delta, output_weights)<br>    hidden_delta2 = hidden_error2 * sigmoid_derivative(hidden_output2)<br><br>    <span class="hljs-comment"># éšè—å±‚ 1 è¯¯å·®</span><br>    hidden_error1 = np.dot(hidden_delta2, hidden_weights2)<br>    hidden_delta1 = hidden_error1 * sigmoid_derivative(hidden_output1)<br><br>    <span class="hljs-comment"># æ›´æ–°æƒé‡å’Œåç½®</span><br>    output_weights += learning_rate * np.dot(output_delta.T, hidden_output2)<br>    output_bias += learning_rate * np.mean(output_delta, axis=<span class="hljs-number">0</span>)<br><br>    hidden_weights2 += learning_rate * np.dot(hidden_delta2.T, hidden_output1)<br>    hidden_bias2 += learning_rate * np.mean(hidden_delta2, axis=<span class="hljs-number">0</span>)<br><br>    hidden_weights1 += learning_rate * np.dot(hidden_delta1.T, inputs)<br>    hidden_bias1 += learning_rate * np.mean(hidden_delta1, axis=<span class="hljs-number">0</span>)<br><br>    <span class="hljs-comment"># æ‰“å°æŸå¤±</span><br>    <span class="hljs-keyword">if</span> epoch % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">&#123;epoch&#125;</span>, Loss: <span class="hljs-subst">&#123;loss&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># æœ€ç»ˆé¢„æµ‹è¾“å‡º</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æœ€ç»ˆé¢„æµ‹è¾“å‡º: <span class="hljs-subst">&#123;predicted_output&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<ul>
<li><strong>å½’ä¸€åŒ– <code>true_outputs</code></strong> æ˜¯ä¸€ç§ç®€å•çš„å¤„ç†æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ çš„ç½‘ç»œè¾“å‡ºä¸ <code>true_outputs</code> åŒ¹é…ã€‚</li>
<li><strong>ä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°</strong> å¯ä»¥é€‚åº”èŒƒå›´è¶…è¿‡ 0-1 çš„ <code>true_outputs</code>ï¼Œé€‚åˆäºå›å½’é—®é¢˜ç­‰æƒ…å†µã€‚</li>
</ul>
<p>ä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„å¤„ç†æ–¹æ³•ï¼Œæˆ–è€…ç»“åˆä¸¤è€…ï¼Œç¡®ä¿ç½‘ç»œè¾“å‡ºä¸ç›®æ ‡èŒƒå›´åŒ¹é…ã€‚å¦‚æœæœ‰è¿›ä¸€æ­¥çš„é—®é¢˜æˆ–éœ€è¦æ›´å¤šè§£é‡Šï¼Œè¯·éšæ—¶å‘ŠçŸ¥ï¼</p>
<h2 id="å„ç±»ç¥ç»ç½‘ç»œåœ¨æŠ•èµ„ä¸­çš„åº”ç”¨">å„ç±»ç¥ç»ç½‘ç»œåœ¨æŠ•èµ„ä¸­çš„åº”ç”¨</h2>
<p>åœ¨æŠ•èµ„é¢†åŸŸï¼Œç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯æœ‰è®¸å¤šåº”ç”¨ï¼Œä¸»è¦ç”¨äºæ•°æ®åˆ†æã€å¸‚åœºé¢„æµ‹ã€äº¤æ˜“ç­–ç•¥çš„è‡ªåŠ¨åŒ–ç­‰ã€‚ä»¥ä¸‹æ˜¯å„ç±»ç¥ç»ç½‘ç»œåœ¨æŠ•èµ„ä¸­çš„å…·ä½“åº”ç”¨åŠé€‚ç”¨æƒ…å†µï¼š</p>
<ol>
<li>
<p><strong>é«˜çº§ä¼˜åŒ–ç®—æ³•</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šä¼˜åŒ–äº¤æ˜“ç­–ç•¥ã€è°ƒä¼˜æ¨¡å‹å‚æ•°ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶æ¨¡å‹è®­ç»ƒè¿‡ç¨‹çš„åœºæ™¯ï¼Œå¦‚é‡åŒ–äº¤æ˜“ç­–ç•¥ä¼˜åŒ–ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ·±åº¦å­¦ä¹ æ¡†æ¶</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¿«é€Ÿæ„å»ºå’Œéƒ¨ç½²å¤æ‚çš„æ¨¡å‹ï¼Œå¦‚è‚¡ç¥¨ä»·æ ¼é¢„æµ‹ã€æŠ•èµ„ç»„åˆä¼˜åŒ–ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºéœ€è¦æ„å»ºå¤§è§„æ¨¡æ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåˆ†æé‡‘èå¸‚åœºä¸­çš„å›¾åƒæ•°æ®ï¼Œå¦‚è‚¡ç¥¨èµ°åŠ¿å›¾ã€è´¢ç»æ–°é—»å›¾ç‰‡ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºä»å›¾åƒæ•°æ®ä¸­æå–ä¿¡æ¯ï¼Œä¾‹å¦‚æŠ€æœ¯å›¾è¡¨åˆ†æï¼Œä½†åœ¨æŠ•èµ„ä¸­åº”ç”¨è¾ƒå°‘ï¼Œé™¤éæ¶‰åŠå›¾åƒæˆ–å›¾è¡¨è¯†åˆ«ã€‚</li>
</ul>
</li>
<li>
<p><strong>é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šæ—¶é—´åºåˆ—é¢„æµ‹ï¼Œå¦‚è‚¡ç¥¨ä»·æ ¼èµ°åŠ¿é¢„æµ‹ã€ç»æµæŒ‡æ ‡åˆ†æã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šéå¸¸é€‚åˆå¤„ç†é‡‘èæ—¶é—´åºåˆ—æ•°æ®ï¼Œèƒ½æ•æ‰é•¿æœŸä¾èµ–å…³ç³»ã€‚LSTM å’Œ GRU æ˜¯å¸¸ç”¨çš„å˜ä½“ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ­£åˆ™åŒ–æŠ€æœ¯</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé˜²æ­¢æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¿‡æ‹Ÿåˆï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºæ‰€æœ‰ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œä»¥æé«˜å…¶ç¨³å®šæ€§å’Œæ€§èƒ½ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¶…å‚æ•°è°ƒä¼˜</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šè‡ªåŠ¨å¯»æ‰¾æœ€ä½³æ¨¡å‹å‚æ•°ç»„åˆï¼Œå¦‚è°ƒä¼˜å­¦ä¹ ç‡ã€å±‚æ•°ã€ç¥ç»å…ƒæ•°é‡ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºéœ€è¦è‡ªåŠ¨åŒ–è°ƒä¼˜è¿‡ç¨‹çš„åœºæ™¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿ç§»å­¦ä¹ </strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹åœ¨é‡‘èæ•°æ®ä¸Šå¾®è°ƒï¼Œå¦‚åˆ©ç”¨æ–°é—»åˆ†ç±»æ¨¡å‹æ¥åˆ†æè´¢ç»æ–°é—»å¯¹å¸‚åœºçš„å½±å“ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºæœ‰ç›¸å…³é¢„è®­ç»ƒæ¨¡å‹ä¸”æ–°ä»»åŠ¡æ•°æ®æœ‰é™çš„æƒ…å†µã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰</strong></p>
<ul>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šç”Ÿæˆè™šæ‹Ÿçš„å¸‚åœºæ•°æ®ç”¨äºæ¨¡æ‹Ÿæˆ–æµ‹è¯•äº¤æ˜“ç­–ç•¥ã€‚</li>
<li><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šé€‚ç”¨äºç”Ÿæˆæ–°çš„æ•°æ®é›†æˆ–å¢å¼ºæ•°æ®é›†ï¼Œä½†åœ¨é‡‘èé¢†åŸŸåº”ç”¨è¾ƒå°‘ã€‚</li>
</ul>
</li>
</ol>
<h3 id="æœ€é€‚åˆæŠ•èµ„çš„ç¥ç»ç½‘ç»œç±»å‹">æœ€é€‚åˆæŠ•èµ„çš„ç¥ç»ç½‘ç»œç±»å‹</h3>
<p>**é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰**åŠå…¶å˜ä½“ï¼ˆå¦‚ LSTM å’Œ GRUï¼‰æ˜¯æŠ•èµ„é¢†åŸŸæœ€å¸¸ç”¨çš„ç¥ç»ç½‘ç»œç±»å‹ï¼Œç‰¹åˆ«é€‚åˆæ—¶é—´åºåˆ—é¢„æµ‹ã€‚è¿™ç±»æ¨¡å‹èƒ½å¤Ÿå¤„ç†è¿‡å»çš„é‡‘èæ•°æ®å¹¶é¢„æµ‹æœªæ¥çš„å¸‚åœºè¡Œä¸ºã€‚</p>
<p><strong>æ·±åº¦å­¦ä¹ æ¡†æ¶</strong>ï¼ˆå¦‚ TensorFlow å’Œ PyTorchï¼‰èƒ½å¤Ÿå¸®åŠ©ä½ å¿«é€Ÿæ„å»ºå’Œéƒ¨ç½²è¿™äº›å¤æ‚çš„æ¨¡å‹ã€‚æ­¤å¤–ï¼Œç»“åˆ<strong>é«˜çº§ä¼˜åŒ–ç®—æ³•</strong>å’Œ<strong>æ­£åˆ™åŒ–æŠ€æœ¯</strong>ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜æ¨¡å‹çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p>
<h3 id="å®ç°æ­¥éª¤">å®ç°æ­¥éª¤</h3>
<h4 id="ä½¿ç”¨-RNN-LSTM-è¿›è¡Œè‚¡ç¥¨ä»·æ ¼é¢„æµ‹">ä½¿ç”¨ RNN/LSTM è¿›è¡Œè‚¡ç¥¨ä»·æ ¼é¢„æµ‹</h4>
<ol>
<li>
<p><strong>æ•°æ®å‡†å¤‡</strong></p>
<ul>
<li>æ”¶é›†å¹¶é¢„å¤„ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œå¦‚è‚¡ç¥¨ä»·æ ¼ã€äº¤æ˜“é‡ç­‰ã€‚</li>
<li>å¸¸è§æ•°æ®æºåŒ…æ‹¬ Yahoo Financeã€Alpha Vantage ç­‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹æ„å»º</strong></p>
<ul>
<li>æ„å»º RNN æˆ– LSTM æ¨¡å‹ï¼Œè®¾å®šè¾“å…¥å±‚ã€éšè—å±‚å’Œè¾“å‡ºå±‚ã€‚</li>
<li>å®šä¹‰æŸå¤±å‡½æ•°ï¼ˆå¦‚ MSEï¼‰å’Œä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚ Adamï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹è®­ç»ƒ</strong></p>
<ul>
<li>ä½¿ç”¨å†å²æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œä½¿ç”¨æ‰¹é‡æ¢¯åº¦ä¸‹é™ä¼˜åŒ–æ¨¡å‹å‚æ•°ã€‚</li>
<li>å¯ä»¥è®¾ç½®å¤šæ¬¡è¿­ä»£ï¼ˆepochsï¼‰å’Œé€‚å½“çš„å­¦ä¹ ç‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹è¯„ä¼°</strong></p>
<ul>
<li>åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œä½¿ç”¨æŒ‡æ ‡å¦‚ RMSEã€MAE ç­‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>é¢„æµ‹å’Œåº”ç”¨</strong></p>
<ul>
<li>ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œæœªæ¥ä»·æ ¼é¢„æµ‹ï¼Œç»“åˆæŠ•èµ„ç­–ç•¥è¿›è¡Œåº”ç”¨ã€‚</li>
</ul>
</li>
</ol>
<h3 id="ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ LSTM è¿›è¡Œè‚¡ç¥¨ä»·æ ¼é¢„æµ‹çš„ç®€åŒ–ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler<br><br><span class="hljs-comment"># è¯»å–æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_stock_data</span>(<span class="hljs-params">file_path</span>):<br>    data = pd.read_csv(file_path, parse_dates=[<span class="hljs-string">&#x27;Date&#x27;</span>], index_col=<span class="hljs-string">&#x27;Date&#x27;</span>)<br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-comment"># ç‰¹å¾å·¥ç¨‹ï¼šè®¡ç®—æŠ€æœ¯æŒ‡æ ‡</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_technical_indicators</span>(<span class="hljs-params">data</span>):<br>    data[<span class="hljs-string">&#x27;SMA&#x27;</span>] = data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">10</span>).mean()<br>    data[<span class="hljs-string">&#x27;EMA&#x27;</span>] = data[<span class="hljs-string">&#x27;close&#x27;</span>].ewm(span=<span class="hljs-number">10</span>, adjust=<span class="hljs-literal">False</span>).mean()<br><br>    delta = data[<span class="hljs-string">&#x27;close&#x27;</span>].diff()<br>    gain = (delta.where(delta &gt; <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).rolling(window=<span class="hljs-number">14</span>).mean()<br>    loss = (-delta.where(delta &lt; <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).rolling(window=<span class="hljs-number">14</span>).mean()<br>    rs = gain / loss<br>    data[<span class="hljs-string">&#x27;RSI&#x27;</span>] = <span class="hljs-number">100</span> - (<span class="hljs-number">100</span> / (<span class="hljs-number">1</span> + rs))<br><br>    data[<span class="hljs-string">&#x27;Bollinger Upper&#x27;</span>] = data[<span class="hljs-string">&#x27;SMA&#x27;</span>] + <span class="hljs-number">2</span> * \<br>        data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">20</span>).std()<br>    data[<span class="hljs-string">&#x27;Bollinger Lower&#x27;</span>] = data[<span class="hljs-string">&#x27;SMA&#x27;</span>] - <span class="hljs-number">2</span> * \<br>        data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">20</span>).std()<br><br>    data = data.dropna()  <span class="hljs-comment"># å»é™¤ NaN å€¼</span><br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-comment"># æ•°æ®é¢„å¤„ç†ï¼šæ ‡å‡†åŒ–</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_data</span>(<span class="hljs-params">data</span>):<br>    scaler = MinMaxScaler(feature_range=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))<br>    scaled_data = scaler.fit_transform(data)<br>    <span class="hljs-keyword">return</span> scaled_data, scaler<br><br><span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_dataset</span>(<span class="hljs-params">data, seq_length</span>):<br>    X, y = [], []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data) - seq_length - <span class="hljs-number">1</span>):<br>        X.append(data[i:(i + seq_length)])<br>        y.append(data[i + seq_length, <span class="hljs-number">3</span>])  <span class="hljs-comment"># é¢„æµ‹ &#x27;Close&#x27; ä»·æ ¼</span><br>    <span class="hljs-keyword">return</span> np.array(X), np.array(y)<br><br><span class="hljs-comment"># LSTM å•å…ƒå®ç°</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LSTMCell</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_size, hidden_size</span>):<br>        <span class="hljs-variable language_">self</span>.input_size = input_size<br>        <span class="hljs-variable language_">self</span>.hidden_size = hidden_size<br>        <span class="hljs-variable language_">self</span>.Wf = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wi = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wc = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wo = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.bf = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bi = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bc = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bo = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x, h_prev, c_prev</span>):<br>        combined = np.concatenate((x, h_prev), axis=<span class="hljs-number">0</span>)<br><br>        ft = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wf, combined) + <span class="hljs-variable language_">self</span>.bf)<br>        it = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wi, combined) + <span class="hljs-variable language_">self</span>.bi)<br>        c_hat = np.tanh(np.dot(<span class="hljs-variable language_">self</span>.Wc, combined) + <span class="hljs-variable language_">self</span>.bc)<br>        c = ft * c_prev + it * c_hat<br>        ot = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wo, combined) + <span class="hljs-variable language_">self</span>.bo)<br>        h = ot * np.tanh(c)<br><br>        <span class="hljs-keyword">return</span> h, c<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-comment"># è®­ç»ƒ LSTM</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">train_lstm</span>(<span class="hljs-params">X, y, hidden_size, epochs, learning_rate</span>):<br>    input_size = X.shape[<span class="hljs-number">2</span>]<br>    lstm_cell = LSTMCell(input_size, hidden_size)<br>    W_out = np.random.randn(<span class="hljs-number">1</span>, hidden_size) * <span class="hljs-number">0.01</span><br>    b_out = np.zeros((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):<br>        total_loss = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">0</span>]):<br>            h_prev = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>            c_prev = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">1</span>]):<br>                x_t = X[i, t, :].reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>                h_prev, c_prev = lstm_cell.forward(x_t, h_prev, c_prev)<br><br>            y_hat = np.dot(W_out, h_prev) + b_out<br>            loss = np.mean((y_hat - y[i]) ** <span class="hljs-number">2</span>)<br>            total_loss += loss<br><br>            <span class="hljs-comment"># åå‘ä¼ æ’­</span><br>            dW_out = (y_hat - y[i]) * h_prev.T<br>            db_out = (y_hat - y[i])<br><br>            <span class="hljs-comment"># dh_prev = np.dot(W_out.T, (y_hat - y[i]))</span><br><br>            W_out -= learning_rate * dW_out<br>            b_out -= learning_rate * db_out<br><br>        <span class="hljs-keyword">if</span> epoch % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">&#123;epoch&#125;</span>, Loss: <span class="hljs-subst">&#123;total_loss / X.shape[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># è¿”å›è®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°</span><br>    <span class="hljs-keyword">return</span> lstm_cell, W_out, b_out<br><br><span class="hljs-comment"># æµ‹è¯• LSTM</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_lstm</span>(<span class="hljs-params">X, lstm_cell, W_out, b_out</span>):<br>    h_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    c_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">1</span>]):<br>        x_t = X[t, :].reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>        h_prev, c_prev = lstm_cell.forward(x_t, h_prev, c_prev)<br>    y_hat = np.dot(W_out, h_prev) + b_out<br>    <span class="hljs-keyword">return</span> y_hat<br><br><br><span class="hljs-comment"># ä¸»æµç¨‹</span><br>file_path = <span class="hljs-string">&#x27;data_600519.csv&#x27;</span><br>data = load_stock_data(file_path)<br>data = calculate_technical_indicators(data)<br>scaled_data, scaler = preprocess_data(<br>    data[[<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>, <span class="hljs-string">&#x27;SMA&#x27;</span>, <span class="hljs-string">&#x27;EMA&#x27;</span>, <span class="hljs-string">&#x27;RSI&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Upper&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Lower&#x27;</span>]])<br>seq_length = <span class="hljs-number">10</span><br>X, y = create_dataset(scaled_data, seq_length)<br><br><span class="hljs-comment"># è®­ç»ƒ LSTM</span><br>hidden_size = <span class="hljs-number">10</span><br>epochs = <span class="hljs-number">500</span><br>learning_rate = <span class="hljs-number">0.5</span><br>lstm_cell, W_out, b_out = train_lstm(X, y, hidden_size, epochs, learning_rate)<br><br><span class="hljs-comment"># é¢„æµ‹</span><br>X_test, y_test = create_dataset(scaled_data[-<span class="hljs-number">20</span>:], seq_length)<br>predicted = [predict_lstm(X_test[i], lstm_cell, W_out, b_out)<br>             <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X_test))]<br>predicted = np.array(predicted).reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><span class="hljs-comment"># æ‰©å±•é¢„æµ‹å€¼</span><br>num_features = scaled_data.shape[<span class="hljs-number">1</span>]  <span class="hljs-comment"># åŸå§‹æ•°æ®çš„ç‰¹å¾æ•°é‡</span><br>predicted_full = np.zeros((predicted.shape[<span class="hljs-number">0</span>], num_features))<br>predicted_full[:, <span class="hljs-number">3</span>] = predicted[:, <span class="hljs-number">0</span>]  <span class="hljs-comment"># å‡è®¾ &#x27;Close&#x27; æ˜¯ç¬¬ 4 åˆ—ï¼ˆç´¢å¼• 3ï¼‰ </span><br><span class="hljs-comment"># è¿›è¡Œé€†å˜æ¢</span><br>original_predicted_full = scaler.inverse_transform(predicted_full)<br>original_predicted = original_predicted_full[:, <span class="hljs-number">3</span>]  <span class="hljs-comment"># æå– &#x27;Close&#x27; åˆ—</span><br>pingjun = np.mean(original_predicted)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ: <span class="hljs-subst">&#123;original_predicted&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ(å¹³å‡å€¼): <span class="hljs-subst">&#123;pingjun&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="æ€»ç»“-v2">æ€»ç»“</h3>
<ul>
<li><strong>RNN/LSTM</strong> éå¸¸é€‚åˆå¤„ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œç”¨äºæŠ•èµ„é¢†åŸŸçš„å¸‚åœºé¢„æµ‹å’Œç­–ç•¥åˆ¶å®šã€‚</li>
<li>ä½ å¯ä»¥ç»“åˆ<strong>æ·±åº¦å­¦ä¹ æ¡†æ¶</strong>å’Œ<strong>é«˜çº§ä¼˜åŒ–ç®—æ³•</strong>æ¥æé«˜æ¨¡å‹çš„æ€§èƒ½å’Œæ•ˆç‡ã€‚</li>
<li>ç»“åˆæŠ•èµ„å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹å’Œæ–¹æ³•ï¼Œé€æ­¥æ„å»ºå’Œä¼˜åŒ–ä½ çš„æŠ•èµ„ç­–ç•¥ã€‚</li>
</ul>
<h3 id="ä»£ç é€è¡Œè§£é‡Šï¼š">ä»£ç é€è¡Œè§£é‡Šï¼š</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler<br><span class="hljs-comment"># è¯»å–æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_stock_data</span>(<span class="hljs-params">file_path</span>):<br>    data = pd.read_csv(file_path, parse_dates=[<span class="hljs-string">&#x27;Date&#x27;</span>], index_col=<span class="hljs-string">&#x27;Date&#x27;</span>)<br>    <span class="hljs-keyword">return</span> data<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>load_stock_data</code> çš„å‡½æ•°ï¼Œç”¨äºåŠ è½½å’Œé¢„å¤„ç†è‚¡ç¥¨æ•°æ®ã€‚è¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•° <code>file_path</code>ï¼Œå³åŒ…å«è‚¡ç¥¨æ•°æ®çš„CSVæ–‡ä»¶çš„è·¯å¾„ã€‚ä¸‹é¢æ˜¯é€è¡Œè§£é‡Šï¼š</p>
<ol>
<li>
<p><code>import numpy as np</code>ï¼šè¿™è¡Œä»£ç å¯¼å…¥äº†NumPyåº“ï¼Œå¹¶å°†å…¶ç®€ç§°ä¸º<code>np</code>ã€‚NumPyæ˜¯Pythonä¸­ç”¨äºç§‘å­¦è®¡ç®—çš„ä¸€ä¸ªåŸºç¡€åº“ï¼Œæä¾›äº†å¤§é‡çš„æ•°å­¦å‡½æ•°æ“ä½œä»¥åŠé«˜æ€§èƒ½çš„å¤šç»´æ•°ç»„å¯¹è±¡ã€‚ç„¶è€Œï¼Œåœ¨è¿™æ®µä»£ç ä¸­ï¼ŒNumPyåº“å®é™…ä¸Šæ²¡æœ‰è¢«ç›´æ¥ä½¿ç”¨ï¼Œå¯èƒ½æ˜¯ä¸ºäº†å…¶ä»–éƒ¨åˆ†çš„ä»£ç ï¼ˆæœªåœ¨æ­¤å±•ç¤ºï¼‰å‡†å¤‡çš„ã€‚</p>
</li>
<li>
<p><code>import pandas as pd</code>ï¼šè¿™è¡Œä»£ç å¯¼å…¥äº†Pandasåº“ï¼Œå¹¶å°†å…¶ç®€ç§°ä¸º<code>pd</code>ã€‚Pandasæ˜¯Pythonä¸­ç”¨äºæ•°æ®åˆ†æçš„ä¸€ä¸ªå¼ºå¤§åº“ï¼Œæä¾›äº†æ˜“äºä½¿ç”¨çš„æ•°æ®ç»“æ„å’Œæ•°æ®åˆ†æå·¥å…·ã€‚è¿™æ®µä»£ç ä¸»è¦ä½¿ç”¨äº†Pandasæ¥å¤„ç†CSVæ ¼å¼çš„è‚¡ç¥¨æ•°æ®ã€‚</p>
</li>
<li>
<p><code>from sklearn.preprocessing import MinMaxScaler</code>ï¼šè¿™è¡Œä»£ç ä»scikit-learnï¼ˆä¸€ä¸ªæµè¡Œçš„Pythonæœºå™¨å­¦ä¹ åº“ï¼‰çš„é¢„å¤„ç†æ¨¡å—ä¸­å¯¼å…¥äº†<code>MinMaxScaler</code>ç±»ã€‚<code>MinMaxScaler</code>ç”¨äºå°†ç‰¹å¾ç¼©æ”¾åˆ°ç»™å®šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼ˆé€šå¸¸æ˜¯0å’Œ1ï¼‰ï¼Œè¿™æ˜¯æ•°æ®é¢„å¤„ç†ä¸­å¸¸ç”¨çš„ä¸€ç§æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©æ”¹å–„è®¸å¤šæœºå™¨å­¦ä¹ ç®—æ³•çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œåœ¨è¿™æ®µç‰¹å®šçš„ä»£ç ä¸­ï¼Œ<code>MinMaxScaler</code>æ²¡æœ‰è¢«ç›´æ¥ä½¿ç”¨ï¼Œå¯èƒ½æ˜¯ä¸ºäº†åç»­çš„æ•°æ®å¤„ç†æ­¥éª¤é¢„ç•™çš„ã€‚</p>
</li>
<li>
<p>å®šä¹‰<code>load_stock_data</code>å‡½æ•°ï¼š</p>
<ul>
<li><code>def load_stock_data(file_path):</code>ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º<code>load_stock_data</code>çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°<code>file_path</code>ï¼Œå³åŒ…å«è‚¡ç¥¨æ•°æ®çš„CSVæ–‡ä»¶çš„è·¯å¾„ã€‚</li>
</ul>
</li>
<li>
<p>åŠ è½½å’Œé¢„å¤„ç†æ•°æ®ï¼š</p>
<ul>
<li><code>data = pd.read_csv(file_path, parse_dates=['Date'], index_col='Date')</code>ï¼šä½¿ç”¨Pandasçš„<code>read_csv</code>å‡½æ•°åŠ è½½CSVæ–‡ä»¶ã€‚<code>parse_dates=['Date']</code>å‚æ•°å‘Šè¯‰Pandaså°†<code>Date</code>åˆ—è§£æä¸ºæ—¥æœŸæ—¶é—´ç±»å‹ã€‚<code>index_col='Date'</code>å‚æ•°æŒ‡å®šå°†<code>Date</code>åˆ—ç”¨ä½œDataFrameçš„è¡Œç´¢å¼•ã€‚è¿™æ„å‘³ç€åŠ è½½åçš„DataFrameå°†ä½¿ç”¨æ—¥æœŸæ—¶é—´ä½œä¸ºç´¢å¼•ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„æ•´æ•°ç´¢å¼•ã€‚</li>
</ul>
</li>
<li>
<p>è¿”å›å¤„ç†åçš„æ•°æ®ï¼š</p>
<ul>
<li><code>return data</code>ï¼šå‡½æ•°è¿”å›å¤„ç†åçš„DataFrameï¼Œå…¶ä¸­åŒ…å«äº†æŒ‰æ—¥æœŸæ—¶é—´ç´¢å¼•çš„è‚¡ç¥¨æ•°æ®ã€‚</li>
</ul>
</li>
</ol>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ®µä»£ç çš„ä¸»è¦ä½œç”¨æ˜¯åŠ è½½ä¸€ä¸ªåŒ…å«è‚¡ç¥¨æ•°æ®çš„CSVæ–‡ä»¶ï¼Œå°†<code>Date</code>åˆ—è§£æä¸ºæ—¥æœŸæ—¶é—´ç±»å‹ï¼Œå¹¶å°†å…¶ä½œä¸ºè¡Œç´¢å¼•ï¼Œç„¶åè¿”å›è¿™ä¸ªå¤„ç†åçš„DataFrameã€‚è™½ç„¶<code>MinMaxScaler</code>è¢«å¯¼å…¥äº†ï¼Œä½†åœ¨è¿™æ®µä»£ç ä¸­å¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ï¼Œå¯èƒ½æ˜¯ä¸ºäº†åç»­çš„æ•°æ®æ ‡å‡†åŒ–æ­¥éª¤å‡†å¤‡çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç‰¹å¾å·¥ç¨‹ï¼šè®¡ç®—æŠ€æœ¯æŒ‡æ ‡</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_technical_indicators</span>(<span class="hljs-params">data</span>):<br>    data[<span class="hljs-string">&#x27;SMA&#x27;</span>] = data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">10</span>).mean()<br>    data[<span class="hljs-string">&#x27;EMA&#x27;</span>] = data[<span class="hljs-string">&#x27;close&#x27;</span>].ewm(span=<span class="hljs-number">10</span>, adjust=<span class="hljs-literal">False</span>).mean()<br><br>    delta = data[<span class="hljs-string">&#x27;close&#x27;</span>].diff()<br>    gain = (delta.where(delta &gt; <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).rolling(window=<span class="hljs-number">14</span>).mean()<br>    loss = (-delta.where(delta &lt; <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).rolling(window=<span class="hljs-number">14</span>).mean()<br>    rs = gain / loss<br>    data[<span class="hljs-string">&#x27;RSI&#x27;</span>] = <span class="hljs-number">100</span> - (<span class="hljs-number">100</span> / (<span class="hljs-number">1</span> + rs))<br><br>    data[<span class="hljs-string">&#x27;Bollinger Upper&#x27;</span>] = data[<span class="hljs-string">&#x27;SMA&#x27;</span>] + <span class="hljs-number">2</span> * \<br>        data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">20</span>).std()<br>    data[<span class="hljs-string">&#x27;Bollinger Lower&#x27;</span>] = data[<span class="hljs-string">&#x27;SMA&#x27;</span>] - <span class="hljs-number">2</span> * \<br>        data[<span class="hljs-string">&#x27;close&#x27;</span>].rolling(window=<span class="hljs-number">20</span>).std()<br><br>    data = data.dropna()  <span class="hljs-comment"># å»é™¤ NaN å€¼</span><br>    <span class="hljs-keyword">return</span> data<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>calculate_technical_indicators</code> çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªåŒ…å«è‚¡ç¥¨ä»·æ ¼æ•°æ®çš„ <code>DataFrame</code>ï¼ˆå‡è®¾è‡³å°‘åŒ…å« <code>close</code> åˆ—ï¼Œå³æ”¶ç›˜ä»·ï¼‰ä½œä¸ºè¾“å…¥ï¼Œå¹¶è®¡ç®—å¹¶æ·»åŠ å‡ ä¸ªå¸¸è§çš„æŠ€æœ¯æŒ‡æ ‡åˆ°è¯¥ <code>DataFrame</code> ä¸­ï¼Œæœ€åè¿”å›æ›´æ–°åçš„ <code>DataFrame</code>ã€‚è¿™äº›æŠ€æœ¯æŒ‡æ ‡åŒ…æ‹¬ç®€å•ç§»åŠ¨å¹³å‡ï¼ˆSMAï¼‰ã€æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼ˆEMAï¼‰ã€ç›¸å¯¹å¼ºå¼±æŒ‡æ•°ï¼ˆRSIï¼‰å’Œå¸ƒæ—å¸¦ï¼ˆBollinger Bandsï¼‰ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†è§£é‡Šï¼š</p>
<ol>
<li>
<p><strong>ç®€å•ç§»åŠ¨å¹³å‡ï¼ˆSMAï¼‰</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>rolling(window=10).mean()</code> è®¡ç®—è¿‡å»10å¤©çš„æ”¶ç›˜ä»·çš„å¹³å‡å€¼ï¼Œç»“æœå­˜å‚¨åœ¨ <code>data['SMA']</code> ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼ˆEMAï¼‰</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>ewm(span=10, adjust=False).mean()</code> è®¡ç®—æŒ‡æ•°ç§»åŠ¨å¹³å‡ã€‚è¿™é‡Œçš„ <code>span=10</code> å¤§è‡´ç›¸å½“äºä¼ ç»Ÿçš„å¹³æ»‘ç³»æ•°ï¼ˆalphaï¼‰çš„å€’æ•°ï¼Œä½† <code>ewm</code> æ–¹æ³•é€šè¿‡ <code>span</code> å‚æ•°è‡ªåŠ¨è®¡ç®—å¹³æ»‘ç³»æ•°ã€‚<code>adjust=False</code> è¡¨ç¤ºä¸ä½¿ç”¨è°ƒæ•´å› å­ï¼ˆå³ä¸å°†EMAçš„åˆå§‹å€¼è®¾ä¸ºç¬¬ä¸€ä¸ªå€¼ï¼‰ã€‚ç»“æœå­˜å‚¨åœ¨ <code>data['EMA']</code> ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç›¸å¯¹å¼ºå¼±æŒ‡æ•°ï¼ˆRSIï¼‰</strong>ï¼š</p>
<ul>
<li>é¦–å…ˆè®¡ç®—æ”¶ç›˜ä»·çš„å·®å¼‚ï¼ˆ<code>delta</code>ï¼‰ï¼Œå³å½“å¤©çš„æ”¶ç›˜ä»·ä¸å‰ä¸€å¤©çš„æ”¶ç›˜ä»·ä¹‹å·®ã€‚</li>
<li>ç„¶ååˆ†åˆ«è®¡ç®—è¿‡å»14å¤©å†…æ‰€æœ‰ä¸Šæ¶¨æ—¥ï¼ˆ<code>gain</code>ï¼‰å’Œä¸‹è·Œæ—¥ï¼ˆ<code>loss</code>ï¼‰çš„å¹³å‡å€¼ã€‚ä¸Šæ¶¨æ—¥å®šä¹‰ä¸º <code>delta &gt; 0</code> çš„æ—¥å­ï¼Œä¸‹è·Œæ—¥å®šä¹‰ä¸º <code>delta &lt; 0</code> çš„æ—¥å­ã€‚æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨äº† <code>where</code> æ–¹æ³•æ¥å°†éä¸Šæ¶¨/ä¸‹è·Œæ—¥çš„å€¼è®¾ä¸º0ï¼Œä»¥ä¾¿è®¡ç®—å¹³å‡å€¼ã€‚</li>
<li>è®¡ç®—RSï¼ˆç›¸å¯¹å¼ºå¼±ï¼‰ï¼Œå³ä¸Šæ¶¨å¹³å‡é™¤ä»¥ä¸‹è·Œå¹³å‡ã€‚</li>
<li>æœ€åï¼Œä½¿ç”¨RSå€¼è®¡ç®—RSIï¼ˆç›¸å¯¹å¼ºå¼±æŒ‡æ•°ï¼‰ï¼Œå…¬å¼ä¸º <code>100 - (100 / (1 + rs))</code>ã€‚ç»“æœå­˜å‚¨åœ¨ <code>data['RSI']</code> ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¸ƒæ—å¸¦ï¼ˆBollinger Bandsï¼‰</strong>ï¼š</p>
<ul>
<li>è®¡ç®—è¿‡å»20å¤©çš„æ”¶ç›˜ä»·çš„æ ‡å‡†å·®ï¼ˆ<code>std()</code>ï¼‰ï¼Œå¹¶ä»¥æ­¤ä¸ºåŸºç¡€è®¡ç®—å¸ƒæ—å¸¦çš„ä¸Šé™å’Œä¸‹é™ã€‚</li>
<li>å¸ƒæ—å¸¦ä¸Šé™æ˜¯ç®€å•ç§»åŠ¨å¹³å‡ï¼ˆSMAï¼‰åŠ ä¸Šä¸¤å€çš„æ ‡å‡†å·®ï¼Œå­˜å‚¨åœ¨ <code>data['Bollinger Upper']</code> ä¸­ã€‚</li>
<li>å¸ƒæ—å¸¦ä¸‹é™æ˜¯ç®€å•ç§»åŠ¨å¹³å‡ï¼ˆSMAï¼‰å‡å»ä¸¤å€çš„æ ‡å‡†å·®ï¼Œå­˜å‚¨åœ¨ <code>data['Bollinger Lower']</code> ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>å»é™¤ NaN å€¼</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>dropna()</code> æ–¹æ³•å»é™¤æ‰€æœ‰åŒ…å«NaNå€¼çš„è¡Œã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºè®¡ç®—ç§»åŠ¨å¹³å‡ã€æ ‡å‡†å·®ç­‰ç»Ÿè®¡é‡æ—¶ï¼Œåœ¨æ•°æ®é›†çš„å¼€å§‹éƒ¨åˆ†ä¼šäº§ç”ŸNaNå€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿”å›æ›´æ–°åçš„ DataFrame</strong>ï¼š</p>
<ul>
<li>å‡½æ•°è¿”å›æ›´æ–°ååŒ…å«æ–°è®¡ç®—çš„æŠ€æœ¯æŒ‡æ ‡çš„ <code>DataFrame</code>ã€‚</li>
</ul>
</li>
</ol>
<p>è¿™ä¸ªå‡½æ•°æ˜¯é‡‘èæ•°æ®åˆ†æä¸­å¸¸ç”¨çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æŠ•èµ„è€…å’Œåˆ†æå¸ˆæ›´å¥½åœ°ç†è§£è‚¡ç¥¨ä»·æ ¼çš„åŠ¨æ€å’Œè¶‹åŠ¿ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ•°æ®é¢„å¤„ç†ï¼šæ ‡å‡†åŒ–</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_data</span>(<span class="hljs-params">data</span>):<br>    scaler = MinMaxScaler(feature_range=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))<br>    scaled_data = scaler.fit_transform(data)<br>    <span class="hljs-keyword">return</span> scaled_data, scaler<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•° <code>preprocess_data</code> çš„ç›®çš„æ˜¯å¯¹ç»™å®šçš„æ•°æ®é›† <code>data</code> è¿›è¡Œé¢„å¤„ç†ï¼Œå…·ä½“æ¥è¯´æ˜¯è¿›è¡Œç‰¹å¾ç¼©æ”¾ï¼ˆFeature Scalingï¼‰ï¼Œå°†æ•°æ®çš„ç‰¹å¾å€¼ç¼©æ”¾åˆ°ä¸€ä¸ªæŒ‡å®šçš„èŒƒå›´å†…ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ 0 åˆ° 1 çš„èŒƒå›´ã€‚è¿™ç§é¢„å¤„ç†æ­¥éª¤å¯¹äºè®¸å¤šæœºå™¨å­¦ä¹ ç®—æ³•æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æ”¹å–„ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦å’Œæ€§èƒ½ã€‚</p>
<p>è®©æˆ‘ä»¬é€è¡Œè§£é‡Šè¿™ä¸ªå‡½æ•°ï¼š</p>
<ol>
<li>
<p><code>scaler = MinMaxScaler(feature_range=(0, 1))</code></p>
<p>è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ª <code>MinMaxScaler</code> å¯¹è±¡ï¼Œå®ƒæ˜¯ä» <code>sklearn.preprocessing</code> æ¨¡å—ä¸­å¯¼å…¥çš„ã€‚<code>MinMaxScaler</code> å°†æ•°æ®ç¼©æ”¾åˆ°ç»™å®šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼ˆè¿™é‡Œæ˜¯ 0 å’Œ 1ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>MinMaxScaler</code> ä¼šå°†æ•°æ®ç¼©æ”¾åˆ° [0, 1]ï¼Œä½†é€šè¿‡è®¾ç½® <code>feature_range</code> å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªèŒƒå›´ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ˜¾å¼åœ°æŒ‡å®šäº† <code>feature_range=(0, 1)</code>ï¼Œå°½ç®¡è¿™æ˜¯é»˜è®¤å€¼ã€‚</p>
</li>
<li>
<p><code>scaled_data = scaler.fit_transform(data)</code></p>
<p>è¿™è¡Œä»£ç æ‰§è¡Œäº†ä¸¤ä¸ªæ­¥éª¤ï¼šé¦–å…ˆï¼Œ<code>fit</code> æ–¹æ³•è®¡ç®—äº†æ•°æ®çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œè¿™æ˜¯è¿›è¡Œç¼©æ”¾æ‰€å¿…éœ€çš„ï¼›ç„¶åï¼Œ<code>transform</code> æ–¹æ³•ä½¿ç”¨è¿™äº›è®¡ç®—å‡ºçš„æœ€å°å€¼å’Œæœ€å¤§å€¼å°†åŸå§‹æ•°æ® <code>data</code> ç¼©æ”¾åˆ°æŒ‡å®šçš„èŒƒå›´å†…ï¼ˆå³ 0 åˆ° 1ï¼‰ã€‚è¿™ä¸¤ä¸ªæ­¥éª¤é€šè¿‡ <code>fit_transform</code> æ–¹æ³•åˆå¹¶ä¸ºä¸€ä¸ªæ­¥éª¤ï¼Œä»¥æé«˜æ•ˆç‡ã€‚<code>scaled_data</code> å˜é‡ç°åœ¨åŒ…å«äº†ç¼©æ”¾åçš„æ•°æ®ã€‚</p>
</li>
<li>
<p><code>return scaled_data, scaler</code></p>
<p>æœ€åï¼Œå‡½æ•°è¿”å›ä¸¤ä¸ªå€¼ï¼šç¼©æ”¾åçš„æ•°æ® <code>scaled_data</code> å’Œ <code>MinMaxScaler</code> å¯¹è±¡ <code>scaler</code>ã€‚è¿”å› <code>scaler</code> å¯¹è±¡å¯èƒ½å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬åœ¨æœªæ¥çš„æ•°æ®ç‚¹ï¼ˆæ¯”å¦‚æµ‹è¯•é›†æˆ–æ–°æ•°æ®ï¼‰ä¸Šä½¿ç”¨ç›¸åŒçš„ç¼©æ”¾å‚æ•°è¿›è¡Œç¼©æ”¾ï¼Œä»¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯æ¯”æ€§ã€‚</p>
</li>
</ol>
<p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªç”¨äºæ•°æ®é¢„å¤„ç†çš„å®ç”¨å·¥å…·ï¼Œå®ƒé€šè¿‡ç‰¹å¾ç¼©æ”¾å°†æ•°æ®é›†çš„ç‰¹å¾å€¼ç¼©æ”¾åˆ° 0 åˆ° 1 çš„èŒƒå›´å†…ï¼Œå¹¶è¿”å›ç¼©æ”¾åçš„æ•°æ®ä»¥åŠç”¨äºç¼©æ”¾çš„ <code>MinMaxScaler</code> å¯¹è±¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_dataset</span>(<span class="hljs-params">data, seq_length</span>):<br>    X, y = [], []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data) - seq_length - <span class="hljs-number">1</span>):<br>        X.append(data[i:(i + seq_length)])<br>        y.append(data[i + seq_length, <span class="hljs-number">3</span>])  <span class="hljs-comment"># é¢„æµ‹ &#x27;Close&#x27; ä»·æ ¼</span><br>    <span class="hljs-keyword">return</span> np.array(X), np.array(y)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•° <code>create_dataset</code> çš„ç›®çš„æ˜¯ä»ç»™å®šçš„æ•°æ® <code>data</code> ä¸­åˆ›å»ºä¸€ä¸ªç”¨äºç›‘ç£å­¦ä¹ ï¼ˆç‰¹åˆ«æ˜¯æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰çš„æ•°æ®é›†ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>data</code> å’Œ <code>seq_length</code>ã€‚<code>data</code> æ˜¯ä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº†æ—¶é—´åºåˆ—æ•°æ®ï¼›<code>seq_length</code> æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å®šäº†æ¯ä¸ªè¾“å…¥åºåˆ—çš„é•¿åº¦ã€‚å‡½æ•°è¿”å›ä¸¤ä¸ªæ•°ç»„ï¼š<code>X</code> å’Œ <code>y</code>ï¼Œå…¶ä¸­ <code>X</code> åŒ…å«è¾“å…¥åºåˆ—ï¼Œ<code>y</code> åŒ…å«æ¯ä¸ªè¾“å…¥åºåˆ—å¯¹åº”çš„ç›®æ ‡å€¼ï¼ˆå³ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„æŸä¸ªç‰¹å®šç‰¹å¾å€¼ï¼‰ã€‚</p>
<p>ä¸è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°ä¸­å­˜åœ¨ä¸€ä¸ªæ½œåœ¨çš„é”™è¯¯æˆ–ä¸ä¸€è‡´ä¹‹å¤„ï¼Œè¿™å–å†³äº <code>data</code> çš„å…·ä½“ç»“æ„ã€‚ä¸‹é¢æ˜¯å¯¹å‡½æ•°è¡Œä¸ºçš„è¯¦ç»†è§£é‡Šå’Œæ½œåœ¨é—®é¢˜çš„è¯´æ˜ï¼š</p>
<ol>
<li>
<p><strong>åˆå§‹åŒ– X å’Œ y</strong>ï¼šå‡½æ•°å¼€å§‹æ—¶ï¼Œé€šè¿‡ç©ºåˆ—è¡¨ <code>X</code> å’Œ <code>y</code> æ¥å­˜å‚¨è¾“å…¥åºåˆ—å’Œç›®æ ‡å€¼ã€‚</p>
</li>
<li>
<p><strong>å¾ªç¯éå†æ•°æ®</strong>ï¼šå‡½æ•°é€šè¿‡ä¸€ä¸ªå¾ªç¯éå† <code>data</code>ï¼Œä»ç´¢å¼• <code>i</code> å¼€å§‹ï¼Œç›´åˆ° <code>len(data) - seq_length - 1</code>ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦æœ‰è¶³å¤Ÿçš„åç»­æ•°æ®æ¥ä½œä¸ºç›®æ ‡å€¼ï¼ˆå³ <code>y</code>ï¼‰ï¼ŒåŒæ—¶ä¿æŒæ¯ä¸ªè¾“å…¥åºåˆ—çš„é•¿åº¦ä¸º <code>seq_length</code>ã€‚</p>
</li>
<li>
<p><strong>æ„å»ºè¾“å…¥åºåˆ— X</strong>ï¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œé€šè¿‡ <code>data[i:(i + seq_length)]</code> ä» <code>data</code> ä¸­åˆ‡å–ä¸€ä¸ªé•¿åº¦ä¸º <code>seq_length</code> çš„åºåˆ—ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° <code>X</code> åˆ—è¡¨ä¸­ã€‚</p>
</li>
<li>
<p><strong>æ„å»ºç›®æ ‡å€¼ y</strong>ï¼šè¿™é‡Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ã€‚ä»£ç  <code>y.append(data[i + seq_length, 3])</code> è¯•å›¾ä» <code>data[i + seq_length]</code> ä¸­è·å–ç¬¬å››ä¸ªå…ƒç´ ï¼ˆç´¢å¼•ä¸º 3ï¼Œå› ä¸ºç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ä½†æ˜¯ï¼Œè¿™å‡è®¾ <code>data</code> æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå¹¶ä¸”æ¯ä¸€è¡Œéƒ½è‡³å°‘æœ‰å››ä¸ªå…ƒç´ ã€‚å¦‚æœ <code>data</code> æ˜¯ä¸€ç»´æ•°ç»„æˆ–æ¯è¡Œçš„å…ƒç´ æ•°é‡å°‘äºå››ä¸ªï¼Œè¿™å°†å¯¼è‡´é”™è¯¯ã€‚æ­¤å¤–ï¼Œå¦‚æœ <code>data</code> æ˜¯ä¸‰ç»´æˆ–æ›´é«˜ç»´çš„ï¼Œè¿™ç§ç´¢å¼•æ–¹å¼ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ã€‚</p>
</li>
<li>
<p><strong>è¿”å›ç»“æœ</strong>ï¼šæœ€åï¼Œå‡½æ•°å°† <code>X</code> å’Œ <code>y</code> åˆ—è¡¨è½¬æ¢ä¸º NumPy æ•°ç»„å¹¶è¿”å›å®ƒä»¬ã€‚</p>
</li>
</ol>
<p><strong>ä¿®æ­£å»ºè®®</strong>ï¼š</p>
<ul>
<li>
<p>å¦‚æœ <code>data</code> æ˜¯ä¸€ç»´æ—¶é—´åºåˆ—æ•°æ®ï¼Œå¹¶ä¸”ä½ æƒ³è¦é¢„æµ‹çš„æ˜¯åºåˆ—ä¸­ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„æŸä¸ªç‰¹å®šå€¼ï¼ˆä½†ä¸ä¸€å®šæ˜¯ç¬¬å››ä¸ªå€¼ï¼‰ï¼Œä½ åº”è¯¥é¦–å…ˆç¡®è®¤è¿™ä¸€ç‚¹ï¼Œå¹¶åœ¨ä»£ç ä¸­æ˜ç¡®è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦é¢„æµ‹çš„æ˜¯ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„å€¼ï¼Œé‚£ä¹ˆä½ å¯ä»¥å°† <code>y.append(data[i + seq_length])</code> æ”¹ä¸º <code>y.append(data[i + seq_length])</code>ï¼ˆä½†è¿™ä¼šå‡è®¾ä½ é¢„æµ‹çš„æ˜¯æ•´ä¸ªåºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œè€Œä¸æ˜¯æŸä¸ªç‰¹å®šç‰¹å¾ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœ <code>data</code> æ˜¯äºŒç»´æˆ–å¤šç»´çš„ï¼Œå¹¶ä¸”ä½ ç¡®å®æƒ³è¦è·å–æ¯ä¸ªåºåˆ—çš„ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„ç¬¬å››ä¸ªå…ƒç´ ä½œä¸ºç›®æ ‡å€¼ï¼Œä½ éœ€è¦ç¡®ä¿ <code>data</code> çš„å½¢çŠ¶å’Œç»“æ„ç¬¦åˆè¿™ç§ç´¢å¼•æ–¹å¼ã€‚</p>
</li>
<li>
<p>å¦‚æœ <code>data</code> çš„å½¢çŠ¶å’Œç»“æ„ä¸ç¡®å®šï¼Œä½ å¯èƒ½éœ€è¦æ·»åŠ ä¸€äº›æ£€æŸ¥æ¥éªŒè¯è¿™äº›å‡è®¾ï¼Œæˆ–è€…åœ¨æ–‡æ¡£ä¸­æ¸…æ¥šåœ°è¯´æ˜å‡½æ•°çš„ä½¿ç”¨æ¡ä»¶å’Œè¦æ±‚ã€‚</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># LSTM å•å…ƒå®ç°</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LSTMCell</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_size, hidden_size</span>):<br>        <span class="hljs-variable language_">self</span>.input_size = input_size<br>        <span class="hljs-variable language_">self</span>.hidden_size = hidden_size<br>        <span class="hljs-variable language_">self</span>.Wf = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wi = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wc = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.Wo = np.random.randn(hidden_size, input_size + hidden_size) * <span class="hljs-number">0.01</span><br>        <span class="hljs-variable language_">self</span>.bf = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bi = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bc = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>        <span class="hljs-variable language_">self</span>.bo = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x, h_prev, c_prev</span>):<br>        <span class="hljs-comment"># # å‡è®¾ x å’Œ h_prev éƒ½æ˜¯ä¸€ç»´æ•°ç»„ï¼Œè½¬æ¢ä¸ºäºŒç»´ä»¥ä¾¿æ‹¼æ¥</span><br>        <span class="hljs-comment"># x = x.reshape(-1, 1)</span><br>        <span class="hljs-comment"># h_prev = h_prev.reshape(-1, 1)</span><br>        combined = np.concatenate((x, h_prev), axis=<span class="hljs-number">0</span>)<br><br>        ft = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wf, combined) + <span class="hljs-variable language_">self</span>.bf)<br>        it = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wi, combined) + <span class="hljs-variable language_">self</span>.bi)<br>        c_hat = np.tanh(np.dot(<span class="hljs-variable language_">self</span>.Wc, combined) + <span class="hljs-variable language_">self</span>.bc)<br>        c = ft * c_prev + it * c_hat<br>        ot = sigmoid(np.dot(<span class="hljs-variable language_">self</span>.Wo, combined) + <span class="hljs-variable language_">self</span>.bo)<br>        h = ot * np.tanh(c)<br><br>        <span class="hljs-keyword">return</span> h, c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br></code></pre></td></tr></table></figure>
<p>æ‚¨æä¾›çš„ <code>LSTMCell</code> ç±»å®ç°äº†ä¸€ä¸ªåŸºæœ¬çš„ LSTM (é•¿çŸ­æœŸè®°å¿†) å•å…ƒçš„å‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚LSTM æ˜¯ä¸€ç§ç‰¹æ®Šçš„ RNN (å¾ªç¯ç¥ç»ç½‘ç»œ) å•å…ƒï¼Œå®ƒé€šè¿‡å¼•å…¥â€œé—¨â€æœºåˆ¶ï¼ˆé—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨ï¼‰æ¥è§£å†³ä¼ ç»Ÿ RNN åœ¨å¤„ç†é•¿åºåˆ—æ—¶å®¹æ˜“å‡ºç°çš„æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ã€‚ä¸‹é¢æ˜¯å¯¹æ‚¨å®ç°çš„è¯¦ç»†è§£é‡Šå’Œå¯èƒ½éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<h4 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h4>
<p>åœ¨ <code>__init__</code> æ–¹æ³•ä¸­ï¼Œæ‚¨ä¸º LSTM å•å…ƒçš„æƒé‡å’Œåç½®é¡¹è¿›è¡Œäº†éšæœºåˆå§‹åŒ–ï¼Œå¹¶å°†å®ƒä»¬ä¹˜ä»¥ä¸€ä¸ªå°çš„ç³»æ•°ï¼ˆè¿™é‡Œæ˜¯ 0.01ï¼‰æ¥å‡å°‘åˆå§‹åŒ–æ—¶çš„éšæœºæ€§å¯¹è®­ç»ƒçš„å½±å“ã€‚è¿™æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„å¸¸è§åšæ³•ï¼Œç§°ä¸ºæƒé‡åˆå§‹åŒ–ã€‚</p>
<h4 id="å‰å‘ä¼ æ’­">å‰å‘ä¼ æ’­</h4>
<p>åœ¨ <code>forward</code> æ–¹æ³•ä¸­ï¼Œæ‚¨å®ç°äº† LSTM çš„å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼Œè¿™åŒ…æ‹¬è®¡ç®—é—å¿˜é—¨ <code>ft</code>ã€è¾“å…¥é—¨ <code>it</code>ã€å€™é€‰å•å…ƒçŠ¶æ€ <code>c_hat</code>ã€æ›´æ–°åçš„å•å…ƒçŠ¶æ€ <code>c</code> å’Œè¾“å‡ºé—¨ <code>ot</code>ï¼Œæœ€åè¾“å‡ºéšè—çŠ¶æ€ <code>h</code>ã€‚</p>
<h4 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h4>
<ol>
<li>
<p><strong>ç»´åº¦åŒ¹é…</strong>ï¼šåœ¨ <code>np.concatenate((x, h_prev), axis=0)</code> ä¸­ï¼Œæ‚¨æ²¿ç€ç¬¬ä¸€ä¸ªè½´ï¼ˆaxis=0ï¼‰æ‹¼æ¥äº†è¾“å…¥ <code>x</code> å’Œå‰ä¸€ä¸ªéšè—çŠ¶æ€ <code>h_prev</code>ã€‚ç„¶è€Œï¼Œåœ¨ LSTM ä¸­ï¼Œé€šå¸¸ <code>x</code> å’Œ <code>h_prev</code> çš„ç»´åº¦åº”è¯¥æ˜¯ <code>(input_size,)</code> å’Œ <code>(hidden_size,)</code>ï¼Œå¹¶ä¸”å®ƒä»¬åº”è¯¥æ²¿ç€ç‰¹å¾ç»´åº¦ï¼ˆå³ç¬¬äºŒç»´ï¼Œaxis=1ï¼‰è¿›è¡Œæ‹¼æ¥ã€‚å› æ­¤ï¼Œæ­£ç¡®çš„æ‹¼æ¥æ–¹å¼åº”è¯¥æ˜¯ <code>np.concatenate((x.reshape(-1, 1), h_prev.reshape(-1, 1)), axis=1)</code>ï¼Œä½†æ›´å¸¸è§çš„æ˜¯ç›´æ¥ä½¿ç”¨ <code>np.hstack((x, h_prev))</code> æˆ–è€…å‡è®¾ <code>x</code> å’Œ <code>h_prev</code> å·²ç»æ˜¯äºŒç»´çš„ï¼Œå¹¶ç›´æ¥æ‹¼æ¥ <code>np.concatenate((x, h_prev), axis=1)</code>ã€‚</p>
</li>
<li>
<p><strong>å¹¿æ’­æœºåˆ¶</strong>ï¼šåœ¨ <code>ft * c_prev + it * c_hat</code> å’Œ <code>ot * np.tanh(c)</code> ä¸­ï¼ŒNumPy çš„å¹¿æ’­æœºåˆ¶ä¼šè‡ªåŠ¨å¤„ç†ä¸åŒå½¢çŠ¶çš„æ•°ç»„ç›¸ä¹˜ã€‚ä½†æ˜¯ï¼Œä¸ºäº†é¿å…æ½œåœ¨çš„ç»´åº¦é—®é¢˜ï¼Œç¡®ä¿ <code>ft</code>, <code>it</code>, <code>c_prev</code>, <code>c_hat</code>, <code>ot</code>, å’Œ <code>c</code> çš„å½¢çŠ¶ç¬¦åˆé¢„æœŸæ˜¯å¾ˆé‡è¦çš„ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè™½ç„¶æ‚¨çš„å®ç°æ˜¯æ•™è‚²å’Œç ”ç©¶ç›®çš„çš„å¥½ä¾‹å­ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½¿ç”¨ä¸“é—¨çš„æ·±åº¦å­¦ä¹ åº“ï¼ˆå¦‚ TensorFlow æˆ– PyTorchï¼‰ä¼šæ›´é«˜æ•ˆï¼Œå› ä¸ºè¿™äº›åº“ç»è¿‡ä¼˜åŒ–ï¼Œå¯ä»¥åœ¨ GPU ä¸Šå¹¶è¡Œå¤„ç†ï¼Œå¹¶æä¾›è‡ªåŠ¨å¾®åˆ†ç­‰åŠŸèƒ½ã€‚</p>
</li>
</ol>
<h4 id="ç¤ºä¾‹ä¿®æ­£">ç¤ºä¾‹ä¿®æ­£</h4>
<p>å‡è®¾ <code>x</code> å’Œ <code>h_prev</code> éƒ½æ˜¯ä¸€ç»´æ•°ç»„ï¼ˆæˆ–éœ€è¦è¢«è½¬æ¢ä¸ºäºŒç»´æ•°ç»„ä»¥ä¾¿æ‹¼æ¥ï¼‰ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç®€åŒ–çš„ä¿®æ­£ç‰ˆæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x, h_prev, c_prev</span>):<br>    <span class="hljs-comment"># å‡è®¾ x å’Œ h_prev éƒ½æ˜¯ä¸€ç»´æ•°ç»„ï¼Œè½¬æ¢ä¸ºäºŒç»´ä»¥ä¾¿æ‹¼æ¥</span><br>    x = x.reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>    h_prev = h_prev.reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>    combined = np.hstack((x, h_prev))<br><br>    <span class="hljs-comment"># ...ï¼ˆæ¥ä¸‹æ¥çš„è®¡ç®—ä¿æŒä¸å˜ï¼‰</span><br><br>    <span class="hljs-keyword">return</span> h, c<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™é‡Œå‡è®¾ <code>x</code> å’Œ <code>h_prev</code> éƒ½æ˜¯æ ‡é‡æˆ–ä¸€ç»´æ•°ç»„ï¼Œå¹¶é€šè¿‡ <code>.reshape(-1, 1)</code> è½¬æ¢ä¸ºäºŒç»´æ•°ç»„ï¼Œç„¶åä½¿ç”¨ <code>np.hstack</code> æ²¿ç€ç¬¬äºŒä¸ªè½´ï¼ˆç‰¹å¾è½´ï¼‰è¿›è¡Œæ‹¼æ¥ã€‚å¦‚æœå®ƒä»¬å·²ç»æ˜¯äºŒç»´çš„ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>np.concatenate</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è®­ç»ƒ LSTM</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">train_lstm</span>(<span class="hljs-params">X, y, hidden_size, epochs, learning_rate</span>):<br>    input_size = X.shape[<span class="hljs-number">2</span>]<br>    lstm_cell = LSTMCell(input_size, hidden_size)<br>    W_out = np.random.randn(<span class="hljs-number">1</span>, hidden_size) * <span class="hljs-number">0.01</span><br>    b_out = np.zeros((<span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br><br>    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):<br>        total_loss = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">0</span>]):<br>            h_prev = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>            c_prev = np.zeros((hidden_size, <span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">1</span>]):<br>                x_t = X[i, t, :].reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>                h_prev, c_prev = lstm_cell.forward(x_t, h_prev, c_prev)<br><br>            y_hat = np.dot(W_out, h_prev) + b_out<br>            loss = np.mean((y_hat - y[i]) ** <span class="hljs-number">2</span>)<br>            total_loss += loss<br><br>            <span class="hljs-comment"># åå‘ä¼ æ’­</span><br>            dW_out = (y_hat - y[i]) * h_prev.T<br>            db_out = (y_hat - y[i])<br><br>            <span class="hljs-comment"># dh_prev = np.dot(W_out.T, (y_hat - y[i]))</span><br><br>            W_out -= learning_rate * dW_out<br>            b_out -= learning_rate * db_out<br><br>        <span class="hljs-keyword">if</span> epoch % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">&#123;epoch&#125;</span>, Loss: <span class="hljs-subst">&#123;total_loss / X.shape[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># è¿”å›è®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°</span><br>    <span class="hljs-keyword">return</span> lstm_cell, W_out, b_out<br></code></pre></td></tr></table></figure>
<p>æ‚¨æä¾›çš„ <code>train_lstm</code> å‡½æ•°å®ç°äº†ä½¿ç”¨å•ä¸ª LSTM å•å…ƒè¿›è¡Œåºåˆ—æ•°æ®è®­ç»ƒçš„åŸºæœ¬æ¡†æ¶ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªå…³é”®çš„é—®é¢˜å’Œé—æ¼ç‚¹éœ€è¦æ³¨æ„å’Œä¿®æ­£ï¼š</p>
<ol>
<li>
<p><strong>åå‘ä¼ æ’­ä¸å®Œæ•´</strong>ï¼š<br>
æ‚¨çš„ä»£ç åªå®ç°äº†è¾“å‡ºå±‚çš„æƒé‡å’Œåç½®çš„æ›´æ–°ï¼Œä½†æ²¡æœ‰å®ç° LSTM å•å…ƒå†…éƒ¨æƒé‡ï¼ˆ<code>Wf</code>, <code>Wi</code>, <code>Wc</code>, <code>Wo</code> å’Œå¯¹åº”çš„åç½® <code>bf</code>, <code>bi</code>, <code>bc</code>, <code>bo</code>ï¼‰çš„æ›´æ–°ã€‚è¿™æ„å‘³ç€ LSTM å•å…ƒçš„å‚æ•°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿æŒä¸å˜ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚</p>
</li>
<li>
<p><strong>æŸå¤±å‡½æ•°å’Œæ¢¯åº¦è®¡ç®—</strong>ï¼š<br>
æ‚¨çš„æŸå¤±å‡½æ•°æ˜¯å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ï¼Œè¿™æ˜¯åˆç†çš„ã€‚ä½†æ˜¯ï¼Œæ¢¯åº¦è®¡ç®— <code>dW_out</code> å’Œ <code>db_out</code> çš„æ–¹å¼åœ¨æ‰¹é‡å¤„ç†æ—¶å¯èƒ½ä¸å¤Ÿå‡†ç¡®ï¼Œå› ä¸ºå®ƒä»¬åªè€ƒè™‘äº†æœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚åœ¨åºåˆ—é¢„æµ‹ä¸­ï¼Œé€šå¸¸éœ€è¦è€ƒè™‘æ•´ä¸ªåºåˆ—çš„æŸå¤±ã€‚</p>
</li>
<li>
<p><strong>LSTM å•å…ƒå†…éƒ¨æ›´æ–°</strong>ï¼š<br>
ä¸ºäº†æ›´æ–° LSTM å•å…ƒå†…éƒ¨çš„æƒé‡ï¼Œæ‚¨éœ€è¦å®ç° LSTM çš„åå‘ä¼ æ’­ç®—æ³•ï¼ˆä¹Ÿç§°ä¸ºé€šè¿‡æ—¶é—´åå‘ä¼ æ’­ BPTTï¼‰ã€‚è¿™æ¶‰åŠåˆ°è®¡ç®—æ¯ä¸ªæ—¶é—´æ­¥çš„è¯¯å·®é¡¹ï¼Œå¹¶å°†å®ƒä»¬åå‘ä¼ æ’­å› LSTM å•å…ƒä»¥æ›´æ–°æƒé‡ã€‚</p>
</li>
<li>
<p><strong>å­¦ä¹ ç‡å’Œä¼˜åŒ–å™¨</strong>ï¼š<br>
æ‚¨ä½¿ç”¨äº†ç®€å•çš„æ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰æ¥æ›´æ–°å‚æ•°ï¼Œè¿™æ˜¯å¯è¡Œçš„ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ›´å¤æ‚çš„ä¼˜åŒ–å™¨ï¼ˆå¦‚ Adamã€RMSprop ç­‰ï¼‰å¯èƒ½æ›´æœ‰æ•ˆã€‚</p>
</li>
<li>
<p><strong>åºåˆ—é•¿åº¦å’Œæ‰¹é‡å¤„ç†</strong>ï¼š<br>
æ‚¨çš„ä»£ç ç›®å‰æ˜¯æŒ‰å•ä¸ªåºåˆ—è¿›è¡Œè®­ç»ƒçš„ï¼Œæ²¡æœ‰å®ç°æ‰¹é‡å¤„ç†ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œé€šå¸¸ä¼šåŒæ—¶å¤„ç†å¤šä¸ªåºåˆ—ã€‚</p>
</li>
</ol>
<p>ç”±äºå®ç° LSTM çš„å®Œæ•´åå‘ä¼ æ’­ç®—æ³•ç›¸å½“å¤æ‚ï¼Œè¿™é‡Œä¸ä¼šç»™å‡ºå®Œæ•´çš„ä»£ç ï¼Œä½†æˆ‘å¯ä»¥æä¾›ä¸€äº›æŒ‡å¯¼æ€è·¯ï¼š</p>
<ul>
<li><strong>å®ç° LSTM çš„åå‘ä¼ æ’­</strong>ï¼šæ‚¨éœ€è¦è®¡ç®—æ¯ä¸ªæ—¶é—´æ­¥çš„è¯¯å·®é¡¹ï¼Œå¹¶å°†å…¶åå‘ä¼ æ’­å› LSTM å•å…ƒã€‚è¿™æ¶‰åŠåˆ°è®¡ç®—å…³äºé—å¿˜é—¨ã€è¾“å…¥é—¨ã€å€™é€‰å•å…ƒçŠ¶æ€å’Œè¾“å‡ºé—¨çš„æ¢¯åº¦ã€‚</li>
<li><strong>æ›´æ–° LSTM æƒé‡</strong>ï¼šä½¿ç”¨åå‘ä¼ æ’­å¾—åˆ°çš„æ¢¯åº¦æ¥æ›´æ–° LSTM å•å…ƒçš„æƒé‡å’Œåç½®ã€‚</li>
<li><strong>è€ƒè™‘åºåˆ—å’Œæ‰¹é‡å¤„ç†</strong>ï¼šåœ¨å¾ªç¯ä¸­åŒæ—¶è¿­ä»£å¤šä¸ªåºåˆ—å’Œæ¯ä¸ªåºåˆ—çš„å¤šä¸ªæ—¶é—´æ­¥ã€‚</li>
</ul>
<p>å¦‚æœæ‚¨æ­£åœ¨å­¦ä¹  LSTM å¹¶å¸Œæœ›é€æ­¥æ„å»ºç†è§£ï¼Œæˆ‘å»ºè®®ä»æ›´ç®€å•çš„ RNN å•å…ƒå¼€å§‹ï¼Œå¹¶é€æ­¥å¢åŠ å¤æ‚æ€§ï¼Œç›´åˆ°æ‚¨èƒ½å¤Ÿå¤„ç† LSTMã€‚åŒæ—¶ï¼Œä½¿ç”¨åƒ TensorFlow æˆ– PyTorch è¿™æ ·çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯ä»¥å¤§å¤§ç®€åŒ–è¿™äº›è¿‡ç¨‹ï¼Œå› ä¸ºå®ƒä»¬å·²ç»ä¸ºæ‚¨å¤„ç†äº†å¤§éƒ¨åˆ†åº•å±‚ç»†èŠ‚ã€‚</p>
<p>å¯¹äºæ‚¨å½“å‰çš„é¡¹ç›®ï¼Œå¦‚æœæ‚¨åªæ˜¯æƒ³å¿«é€Ÿäº†è§£ LSTM çš„åŸºæœ¬å·¥ä½œåŸç†ï¼Œå¹¶ä¸”ä¸æ‰“ç®—æ·±å…¥å®ç°å…¶åå‘ä¼ æ’­ç®—æ³•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¡†æ¶æ¥æ„å»ºå’Œè®­ç»ƒ LSTM æ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æµ‹è¯• LSTM</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_lstm</span>(<span class="hljs-params">X, lstm_cell, W_out, b_out</span>):<br>    h_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    c_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">1</span>]):<br>        x_t = X[t, :].reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>        h_prev, c_prev = lstm_cell.forward(x_t, h_prev, c_prev)<br>    y_hat = np.dot(W_out, h_prev) + b_out<br>    <span class="hljs-keyword">return</span> y_hat<br></code></pre></td></tr></table></figure>
<p>æ‚¨æä¾›çš„ <code>predict_lstm</code> å‡½æ•°å®ç°äº†ä½¿ç”¨è®­ç»ƒå¥½çš„ LSTM å•å…ƒè¿›è¡Œåºåˆ—é¢„æµ‹çš„è¿‡ç¨‹ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶è¾“å…¥åºåˆ— <code>X</code>ã€è®­ç»ƒå¥½çš„ LSTM å•å…ƒ <code>lstm_cell</code>ã€è¾“å‡ºå±‚çš„æƒé‡ <code>W_out</code> å’Œåç½® <code>b_out</code>ï¼Œå¹¶è¿”å›é¢„æµ‹çš„è¾“å‡º <code>y_hat</code>ã€‚ä¸è¿‡ï¼Œæœ‰å‡ ä¸ªå°åœ°æ–¹å¯èƒ½éœ€è¦è°ƒæ•´æˆ–æ³¨æ„ï¼š</p>
<ol>
<li>
<p><strong>è¾“å…¥åºåˆ—çš„å½¢çŠ¶</strong>ï¼š<br>
åœ¨æ‚¨çš„å‡½æ•°ä¸­ï¼Œæ‚¨å‡è®¾äº† <code>X</code> çš„å½¢çŠ¶æ˜¯ <code>(time_steps, input_size)</code>ï¼Œå³å®ƒæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€ç»´æ˜¯æ—¶é—´æ­¥é•¿ï¼Œç¬¬äºŒç»´æ˜¯æ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥ç‰¹å¾æ•°é‡ã€‚è¿™é€šå¸¸æ˜¯åˆç†çš„ï¼Œä½†è¯·ç¡®ä¿è¿™ä¸æ‚¨è®­ç»ƒ LSTM æ—¶ä½¿ç”¨çš„è¾“å…¥åºåˆ—å½¢çŠ¶ç›¸åŒ¹é…ã€‚</p>
</li>
<li>
<p><strong>è¾“å‡ºå½¢çŠ¶</strong>ï¼š<br>
<code>y_hat</code> çš„å½¢çŠ¶å°†æ˜¯ <code>(1, 1)</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå•ä¸ªé¢„æµ‹å€¼ï¼ˆå‡è®¾ <code>W_out</code> çš„å½¢çŠ¶æ˜¯ <code>(1, hidden_size)</code>ï¼‰ã€‚å¦‚æœæ‚¨çš„ä»»åŠ¡æ˜¯å¤šç±»åˆ«åˆ†ç±»æˆ–éœ€è¦å¤šä¸ªè¾“å‡ºå€¼ï¼Œæ‚¨éœ€è¦ç›¸åº”åœ°è°ƒæ•´ <code>W_out</code> çš„å½¢çŠ¶ã€‚</p>
</li>
<li>
<p><strong>å¹¿æ’­æœºåˆ¶</strong>ï¼š<br>
åœ¨ <code>np.dot(W_out, h_prev) + b_out</code> ä¸­ï¼ŒNumPy çš„å¹¿æ’­æœºåˆ¶å°†ç¡®ä¿ <code>b_out</code>ï¼ˆå½¢çŠ¶ <code>(1, 1)</code>ï¼‰è¢«æ­£ç¡®åœ°æ·»åŠ åˆ° <code>np.dot(W_out, h_prev)</code> çš„ç»“æœä¸­ã€‚ä½†æ˜¯ï¼Œè¯·ç¡®ä¿ <code>W_out</code> å’Œ <code>h_prev</code> çš„å½¢çŠ¶æ˜¯å…¼å®¹çš„ã€‚</p>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼š<br>
æ‚¨çš„å‡½æ•°æ²¡æœ‰é”™è¯¯å¤„ç†æœºåˆ¶ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ·»åŠ ä¸€äº›åŸºæœ¬çš„é”™è¯¯æ£€æŸ¥ï¼ˆå¦‚æ£€æŸ¥è¾“å…¥å½¢çŠ¶ã€æƒé‡å’Œåç½®çš„å½¢çŠ¶ç­‰ï¼‰æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚</p>
</li>
<li>
<p><strong>æ‰¹é‡é¢„æµ‹</strong>ï¼š<br>
å½“å‰å‡½æ•°åªèƒ½å¯¹å•ä¸ªåºåˆ—è¿›è¡Œé¢„æµ‹ã€‚å¦‚æœæ‚¨éœ€è¦åŒæ—¶é¢„æµ‹å¤šä¸ªåºåˆ—ï¼Œæ‚¨éœ€è¦å°†è¿™ä¸ªå‡½æ•°åŒ…è£…åœ¨ä¸€ä¸ªå¾ªç¯æˆ–å‡½æ•°ä¸­ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿­ä»£å¤šä¸ªè¾“å…¥åºåˆ—ã€‚</p>
</li>
<li>
<p><strong>å‡½æ•°æ³¨é‡Š</strong>ï¼š<br>
æ·»åŠ å‡½æ•°æ³¨é‡Šå¯ä»¥å¸®åŠ©å…¶ä»–å¼€å‘è€…ï¼ˆæˆ–æœªæ¥çš„æ‚¨ï¼‰æ›´å¥½åœ°ç†è§£å‡½æ•°çš„ç”¨é€”ã€å‚æ•°å’Œè¿”å›å€¼ã€‚</p>
</li>
</ol>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ·»åŠ äº†ç®€å•æ³¨é‡Šçš„ <code>predict_lstm</code> å‡½æ•°ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_lstm</span>(<span class="hljs-params">X, lstm_cell, W_out, b_out</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä½¿ç”¨è®­ç»ƒå¥½çš„ LSTM å•å…ƒè¿›è¡Œåºåˆ—é¢„æµ‹ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    å‚æ•°:</span><br><span class="hljs-string">    - X: è¾“å…¥åºåˆ—ï¼Œå½¢çŠ¶ä¸º (time_steps, input_size)</span><br><span class="hljs-string">    - lstm_cell: è®­ç»ƒå¥½çš„ LSTMCell å®ä¾‹</span><br><span class="hljs-string">    - W_out: è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µï¼Œå½¢çŠ¶ä¸º (num_outputs, hidden_size)</span><br><span class="hljs-string">    - b_out: è¾“å‡ºå±‚çš„åç½®å‘é‡ï¼Œå½¢çŠ¶ä¸º (num_outputs, 1)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    è¿”å›:</span><br><span class="hljs-string">    - y_hat: é¢„æµ‹çš„è¾“å‡ºå€¼ï¼Œå½¢çŠ¶ä¸º (num_outputs, 1)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    h_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    c_prev = np.zeros((lstm_cell.hidden_size, <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(X.shape[<span class="hljs-number">0</span>]):  <span class="hljs-comment"># æ³¨æ„è¿™é‡Œä½¿ç”¨ X.shape[0] éå†æ—¶é—´æ­¥</span><br>        x_t = X[t, :].reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>        h_prev, c_prev = lstm_cell.forward(x_t, h_prev, c_prev)<br>    y_hat = np.dot(W_out, h_prev) + b_out<br>    <span class="hljs-keyword">return</span> y_hat<br></code></pre></td></tr></table></figure>
<p>è¯·æ³¨æ„ï¼Œæˆ‘åœ¨éå†æ—¶é—´æ­¥æ—¶ä½¿ç”¨äº† <code>X.shape[0]</code> è€Œä¸æ˜¯ <code>X.shape[1]</code>ï¼Œå› ä¸º <code>X</code> çš„å½¢çŠ¶æ˜¯ <code>(time_steps, input_size)</code>ï¼Œæ‰€ä»¥æ—¶é—´æ­¥æ•°åº”è¯¥æ˜¯ç¬¬ä¸€ç»´ã€‚å¦‚æœæ‚¨çš„ <code>X</code> å½¢çŠ¶å®é™…ä¸Šæ˜¯ <code>(batch_size, time_steps, input_size)</code>ï¼ˆå³åŒ…å«æ‰¹é‡å¤„ç†ï¼‰ï¼Œåˆ™æ‚¨éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹è¿™ä¸ªå‡½æ•°ä»¥å¤„ç†æ‰¹é‡æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä¸»æµç¨‹</span><br>file_path = <span class="hljs-string">&#x27;data_600519.csv&#x27;</span><br>data = load_stock_data(file_path)<br>data = calculate_technical_indicators(data)<br>scaled_data, scaler = preprocess_data(<br>    data[[<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>, <span class="hljs-string">&#x27;SMA&#x27;</span>, <span class="hljs-string">&#x27;EMA&#x27;</span>, <span class="hljs-string">&#x27;RSI&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Upper&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Lower&#x27;</span>]])<br>seq_length = <span class="hljs-number">10</span><br>X, y = create_dataset(scaled_data, seq_length)<br></code></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¯¹æ‚¨æä¾›çš„ä»£ç æ®µè¿›è¡Œé€è¡Œè§£é‡Šï¼ŒåŒ…æ‹¬æ³¨é‡Šï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å®šä¹‰è‚¡ç¥¨æ•°æ®æ–‡ä»¶çš„è·¯å¾„</span><br>file_path = <span class="hljs-string">&#x27;data_600519.csv&#x27;</span><br><br><span class="hljs-comment"># åŠ è½½è‚¡ç¥¨æ•°æ®æ–‡ä»¶ï¼Œè¿™é‡Œå‡è®¾load_stock_dataæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œç”¨äºä»CSVæ–‡ä»¶ä¸­è¯»å–å¹¶å¤„ç†è‚¡ç¥¨æ•°æ®</span><br><span class="hljs-comment"># å‡½æ•°å¯èƒ½è¿”å›Pandas DataFrameå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«è‚¡ç¥¨çš„å„ç§æ•°æ®ï¼ˆå¦‚å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ç­‰ï¼‰</span><br>data = load_stock_data(file_path)<br><br><span class="hljs-comment"># è®¡ç®—æŠ€æœ¯æŒ‡æ ‡ï¼Œè¿™é‡Œå‡è®¾calculate_technical_indicatorsæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°</span><br><span class="hljs-comment"># å®ƒæ¥æ”¶è‚¡ç¥¨æ•°æ®DataFrameä½œä¸ºè¾“å…¥ï¼Œå¹¶è®¡ç®—ä¸€äº›æŠ€æœ¯æŒ‡æ ‡ï¼ˆå¦‚ç®€å•ç§»åŠ¨å¹³å‡SMAã€æŒ‡æ•°ç§»åŠ¨å¹³å‡EMAã€ç›¸å¯¹å¼ºå¼±æŒ‡æ•°RSIã€å¸ƒæ—å¸¦ç­‰ï¼‰</span><br><span class="hljs-comment"># ç„¶åå°†è¿™äº›æŒ‡æ ‡ä½œä¸ºæ–°åˆ—æ·»åŠ åˆ°åŸå§‹DataFrameä¸­ï¼Œå¹¶è¿”å›æ›´æ–°åçš„DataFrame</span><br>data = calculate_technical_indicators(data)<br><br><span class="hljs-comment"># æ•°æ®é¢„å¤„ç†ï¼Œè¿™é‡Œå‡è®¾preprocess_dataæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°</span><br><span class="hljs-comment"># å®ƒæ¥æ”¶åŒ…å«é€‰å®šç‰¹å¾ï¼ˆå¦‚å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ã€æˆäº¤é‡ã€è®¡ç®—å‡ºçš„æŠ€æœ¯æŒ‡æ ‡ç­‰ï¼‰çš„DataFrameä½œä¸ºè¾“å…¥</span><br><span class="hljs-comment"># å‡½æ•°é¦–å…ˆå¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ï¼ˆå¯èƒ½æ˜¯å½’ä¸€åŒ–æˆ–æ ‡å‡†åŒ–ï¼‰ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ </span><br><span class="hljs-comment"># ç„¶åè¿”å›ç¼©æ”¾åçš„æ•°æ®ä»¥åŠç”¨äºç¼©æ”¾æ•°æ®çš„scalerå¯¹è±¡ï¼ˆè¿™å¯èƒ½åœ¨åç»­çš„æ•°æ®é¢„æµ‹ä¸­éœ€è¦ç”¨åˆ°ï¼‰</span><br>scaled_data, scaler = preprocess_data(<br>    data[[<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>, <span class="hljs-string">&#x27;SMA&#x27;</span>, <span class="hljs-string">&#x27;EMA&#x27;</span>, <span class="hljs-string">&#x27;RSI&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Upper&#x27;</span>, <span class="hljs-string">&#x27;Bollinger Lower&#x27;</span>]]<br>)<br><br><span class="hljs-comment"># å®šä¹‰åºåˆ—é•¿åº¦ï¼Œè¿™æ˜¯æ—¶é—´åºåˆ—åˆ†æä¸­å¸¸ç”¨çš„ä¸€ä¸ªå‚æ•°</span><br><span class="hljs-comment"># å®ƒå†³å®šäº†æ¨¡å‹åœ¨é¢„æµ‹æ—¶è€ƒè™‘çš„å†å²æ•°æ®ç‚¹çš„æ•°é‡</span><br>seq_length = <span class="hljs-number">10</span><br><br><span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†ï¼Œè¿™é‡Œå‡è®¾create_datasetæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°</span><br><span class="hljs-comment"># å®ƒæ¥æ”¶ç¼©æ”¾åçš„æ•°æ®å’Œåºåˆ—é•¿åº¦ä½œä¸ºè¾“å…¥</span><br><span class="hljs-comment"># å‡½æ•°çš„ä½œç”¨æ˜¯å°†ç¼©æ”¾åçš„æ•°æ®è½¬æ¢ä¸ºé€‚åˆæ¨¡å‹è®­ç»ƒçš„æ ¼å¼</span><br><span class="hljs-comment"># é€šå¸¸ï¼Œè¿™æ„å‘³ç€å°†æ—¶é—´åºåˆ—æ•°æ®è½¬æ¢ä¸ºç›‘ç£å­¦ä¹ é—®é¢˜æ‰€éœ€çš„è¾“å…¥ï¼ˆXï¼‰å’Œç›®æ ‡ï¼ˆyï¼‰</span><br><span class="hljs-comment"># åœ¨æ—¶é—´åºåˆ—é¢„æµ‹ä¸­ï¼ŒXé€šå¸¸æ˜¯å¤šä¸ªè¿ç»­çš„æ—¶é—´æ­¥ï¼Œè€Œyæ˜¯ç´§éšå…¶åçš„æ—¶é—´æ­¥çš„æŸä¸ªå€¼ï¼ˆå¦‚ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„æ”¶ç›˜ä»·ï¼‰</span><br>X, y = create_dataset(scaled_data, seq_length)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è®­ç»ƒ LSTM</span><br>hidden_size = <span class="hljs-number">10</span><br>epochs = <span class="hljs-number">500</span><br>learning_rate = <span class="hljs-number">0.5</span><br>lstm_cell, W_out, b_out = train_lstm(X, y, hidden_size, epochs, learning_rate)<br><br><span class="hljs-comment"># é¢„æµ‹</span><br>X_test, y_test = create_dataset(scaled_data[-<span class="hljs-number">20</span>:], seq_length)<br>predicted = [predict_lstm(X_test[i], lstm_cell, W_out, b_out)<br>             <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X_test))]<br>predicted = np.array(predicted).reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><span class="hljs-comment"># æ‰©å±•é¢„æµ‹å€¼</span><br>num_features = scaled_data.shape[<span class="hljs-number">1</span>]  <span class="hljs-comment"># åŸå§‹æ•°æ®çš„ç‰¹å¾æ•°é‡</span><br>predicted_full = np.zeros((predicted.shape[<span class="hljs-number">0</span>], num_features))<br>predicted_full[:, <span class="hljs-number">3</span>] = predicted[:, <span class="hljs-number">0</span>]  <span class="hljs-comment"># å‡è®¾ &#x27;Close&#x27; æ˜¯ç¬¬ 4 åˆ—ï¼ˆç´¢å¼• 3ï¼‰</span><br><span class="hljs-comment"># è¿›è¡Œé€†å˜æ¢</span><br>original_predicted_full = scaler.inverse_transform(predicted_full)<br>original_predicted = original_predicted_full[:, <span class="hljs-number">3</span>]  <span class="hljs-comment"># æå– &#x27;Close&#x27; åˆ—</span><br>pingjun = np.mean(original_predicted)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ: <span class="hljs-subst">&#123;original_predicted&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ(å¹³å‡å€¼): <span class="hljs-subst">&#123;pingjun&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>åœ¨æ‚¨æä¾›çš„ä»£ç æ®µä¸­ï¼Œæ‚¨é¦–å…ˆè®­ç»ƒäº†ä¸€ä¸ªLSTMæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨è¯¥æ¨¡å‹è¿›è¡Œäº†é¢„æµ‹ã€‚ç„¶è€Œï¼Œæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„æˆ–å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä»¥ç¡®ä¿ä»£ç èƒ½å¤Ÿæ­£ç¡®è¿è¡Œå¹¶äº§ç”Ÿé¢„æœŸçš„ç»“æœã€‚ä»¥ä¸‹æ˜¯å¯¹ä»£ç æ®µçš„è¯¦ç»†è§£é‡Šå’Œå¯èƒ½çš„ä¿®æ”¹å»ºè®®ï¼š</p>
<ol>
<li>
<p><strong>è®­ç»ƒ LSTM</strong>ï¼š<br>
æ‚¨å‡è®¾æœ‰ä¸€ä¸ªåä¸º <code>train_lstm</code> çš„å‡½æ•°ï¼Œå®ƒæ¥æ”¶è¾“å…¥æ•°æ® <code>X</code>ã€ç›®æ ‡æ•°æ® <code>y</code>ã€éšè—å±‚å¤§å° <code>hidden_size</code>ã€è®­ç»ƒè½®æ¬¡ <code>epochs</code> å’Œå­¦ä¹ ç‡ <code>learning_rate</code>ï¼Œå¹¶è¿”å›è®­ç»ƒå¥½çš„ LSTM å•å…ƒã€è¾“å‡ºå±‚æƒé‡ <code>W_out</code> å’Œåç½® <code>b_out</code>ã€‚è¿™ä¸ªå‡½æ•°çš„å…·ä½“å®ç°ä¸åœ¨æ‚¨æä¾›çš„ä»£ç æ®µä¸­ï¼Œä½†å®ƒæ˜¯å…³é”®éƒ¨åˆ†ï¼Œéœ€è¦ç¡®ä¿å®ƒæ­£ç¡®å®ç°äº† LSTM çš„è®­ç»ƒè¿‡ç¨‹ã€‚</p>
</li>
<li>
<p><strong>é¢„æµ‹</strong>ï¼š</p>
<ul>
<li>æ‚¨ä½¿ç”¨ <code>create_dataset</code> å‡½æ•°ä» <code>scaled_data</code> çš„æœ€å 20 ä¸ªæ—¶é—´ç‚¹ä¸­åˆ›å»ºäº†ä¸€ä¸ªæµ‹è¯•æ•°æ®é›† <code>X_test</code> å’Œ <code>y_test</code>ã€‚è¯·æ³¨æ„ï¼Œç”±äºæ‚¨æ­£åœ¨ä½¿ç”¨ LSTM è¿›è¡Œé¢„æµ‹ï¼Œå› æ­¤å®é™…ä¸Šå¯èƒ½ä¸éœ€è¦ <code>y_test</code>ï¼ˆé™¤éæ‚¨æ‰“ç®—åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼‰ã€‚</li>
<li>æ‚¨å®šä¹‰äº†ä¸€ä¸ª <code>predict_lstm</code> å‡½æ•°ï¼ˆå°½ç®¡å®ƒçš„å®ç°ç»†èŠ‚ä¸åœ¨è¿™é‡Œï¼‰ï¼Œè¯¥å‡½æ•°åº”è¯¥æ¥æ”¶å•ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥åºåˆ— <code>X_test[i]</code>ã€LSTM å•å…ƒã€è¾“å‡ºå±‚æƒé‡å’Œåç½®ï¼Œå¹¶è¿”å›é¢„æµ‹ç»“æœã€‚ç„¶è€Œï¼Œåœ¨ LSTM çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œé€šå¸¸ä¸€æ¬¡é¢„æµ‹å¤šä¸ªæ—¶é—´æ­¥ï¼ˆä½¿ç”¨æ»‘åŠ¨çª—å£æˆ–ç±»ä¼¼æ–¹æ³•ï¼‰ï¼Œä½†è¿™é‡Œæ‚¨ä¼¼ä¹æ˜¯å¯¹æ¯ä¸ªæ—¶é—´æ­¥å•ç‹¬è¿›è¡Œé¢„æµ‹ã€‚</li>
<li>æ‚¨å°†é¢„æµ‹ç»“æœæ”¶é›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º NumPy æ•°ç»„ã€‚ç„¶åï¼Œæ‚¨åˆ›å»ºäº†ä¸€ä¸ªä¸åŸå§‹æ•°æ®ç‰¹å¾æ•°é‡ç›¸åŒå¤§å°çš„é›¶æ•°ç»„ <code>predicted_full</code>ï¼Œå¹¶å°†é¢„æµ‹ç»“æœï¼ˆå‡è®¾æ˜¯æ”¶ç›˜ä»·ï¼‰æ”¾å…¥è¯¥æ•°ç»„çš„é€‚å½“åˆ—ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong>é€†å˜æ¢å’Œç»“æœæå–</strong>ï¼š</p>
<ul>
<li>æ‚¨ä½¿ç”¨ <code>scaler.inverse_transform</code> æ–¹æ³•å°†ç¼©æ”¾åçš„é¢„æµ‹æ•°æ®è½¬æ¢å›åŸå§‹æ¯”ä¾‹ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºæ¨¡å‹æ˜¯åœ¨ç¼©æ”¾åçš„æ•°æ®ä¸Šè®­ç»ƒçš„ã€‚</li>
<li>æ‚¨ä»è½¬æ¢åçš„æ•°æ®ä¸­æå–äº†â€œCloseâ€åˆ—çš„é¢„æµ‹å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¯èƒ½çš„ä¿®æ”¹</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿ <code>predict_lstm</code> å‡½æ•°èƒ½å¤Ÿå¤„ç†å•ä¸ªæ—¶é—´æ­¥çš„è¾“å…¥ï¼Œå¹¶è¿”å›æ­£ç¡®çš„é¢„æµ‹å€¼ã€‚å¦‚æœ LSTM å•å…ƒè®¾è®¡ä¸ºå¤„ç†å¤šä¸ªæ—¶é—´æ­¥ï¼Œåˆ™å¯èƒ½éœ€è¦ä¿®æ”¹è¯¥å‡½æ•°ä»¥é€‚åº”è¿™ä¸€ç‚¹ã€‚</li>
<li>å¦‚æœæ‚¨çš„ç›®æ ‡æ˜¯è¿›è¡Œå¤šæ­¥é¢„æµ‹ï¼ˆå³é¢„æµ‹æœªæ¥å¤šä¸ªæ—¶é—´ç‚¹çš„æ”¶ç›˜ä»·ï¼‰ï¼Œåˆ™å¯èƒ½éœ€è¦ä¿®æ”¹é¢„æµ‹å¾ªç¯ä»¥ç”Ÿæˆå¤šä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹ã€‚</li>
<li>éªŒè¯ <code>scaler</code> æ˜¯å¦ç¡®å®åŒ…å«äº†ç”¨äºé€†å˜æ¢æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œå‡å€¼å’Œæ ‡å‡†å·®ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p>
<ul>
<li>æ‚¨æ‰“å°äº†é¢„æµ‹ç»“æœåŠå…¶å¹³å‡å€¼ã€‚è¿™å¯ä»¥å¸®åŠ©æ‚¨äº†è§£æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>LSTM é€šå¸¸ç”¨äºå¤„ç†åºåˆ—æ•°æ®ï¼Œå¹¶ä¸”ä¸€æ¬¡å¯ä»¥å¤„ç†å¤šä¸ªæ—¶é—´æ­¥ã€‚åœ¨æ‚¨çš„ä»£ç ä¸­ï¼Œæ‚¨ä¼¼ä¹å¯¹æ¯ä¸ªæ—¶é—´æ­¥å•ç‹¬è¿›è¡Œäº†é¢„æµ‹ï¼Œè¿™åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ã€‚</li>
<li>ç¡®ä¿ <code>scaler</code> å’Œå…¶ä»–é¢„å¤„ç†æ­¥éª¤ï¼ˆå¦‚ç‰¹å¾é€‰æ‹©ï¼‰åœ¨è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¸Šä¿æŒä¸€è‡´ã€‚</li>
</ul>
</li>
</ol>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„é¢„æµ‹æ­¥éª¤ç¤ºä¾‹ï¼Œå‡è®¾ <code>predict_lstm</code> å‡½æ•°å·²ç»èƒ½å¤Ÿå¤„ç†æ•´ä¸ªåºåˆ—ï¼ˆè€Œä¸ä»…ä»…æ˜¯å•ä¸ªæ—¶é—´æ­¥ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å‡è®¾ predict_lstm ç°åœ¨å¯ä»¥å¤„ç†æ•´ä¸ªåºåˆ— X_test</span><br>predicted_full = predict_lstm(X_test, lstm_cell, W_out, b_out)<br><span class="hljs-comment"># æ³¨æ„ï¼šè¿™é‡Œ predicted_full çš„å½¢çŠ¶åº”è¯¥ä¸ scaled_data çš„ç›¸åº”éƒ¨åˆ†ç›¸åŒ¹é…</span><br><span class="hljs-comment"># é€†å˜æ¢å’Œç»“æœæå–ä¿æŒä¸å˜</span><br>original_predicted_full = scaler.inverse_transform(predicted_full)<br>original_predicted = original_predicted_full[:, <span class="hljs-number">3</span>]  <span class="hljs-comment"># æå– &#x27;Close&#x27; åˆ—</span><br>pingjun = np.mean(original_predicted)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ: <span class="hljs-subst">&#123;original_predicted&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹ç»“æœ(å¹³å‡å€¼): <span class="hljs-subst">&#123;pingjun&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œè¿™ä¸ªç®€åŒ–çš„ç¤ºä¾‹å‡è®¾ <code>predict_lstm</code> å·²ç»è¢«ç›¸åº”åœ°ä¿®æ”¹ä»¥å¤„ç†æ•´ä¸ªåºåˆ—ã€‚å¦‚æœå®ƒä»ç„¶åªèƒ½å¤„ç†å•ä¸ªæ—¶é—´æ­¥ï¼Œåˆ™æ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨å¾ªç¯æˆ–å…¶ä»–æ–¹æ³•æ¥ç”Ÿæˆæ•´ä¸ªåºåˆ—çš„é¢„æµ‹ã€‚</p>
<h2 id="ç”¨äºæŠ“å–è‚¡ä»·çš„pythonä»£ç ">ç”¨äºæŠ“å–è‚¡ä»·çš„<code>python</code>ä»£ç </h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding:utf-8 -*-    --------------Ashare è‚¡ç¥¨è¡Œæƒ…æ•°æ®åŒæ ¸å¿ƒç‰ˆ( https://github.com/mpquant/Ashare )</span><br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd  <span class="hljs-comment">#</span><br><br><span class="hljs-comment"># è…¾è®¯æ—¥çº¿</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_price_day_tx</span>(<span class="hljs-params">code, end_date=<span class="hljs-string">&#x27;&#x27;</span>, count=<span class="hljs-number">10</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span></span>):  <span class="hljs-comment"># æ—¥çº¿è·å–</span><br>    unit = <span class="hljs-string">&#x27;week&#x27;</span> <span class="hljs-keyword">if</span> frequency <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;1w&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;month&#x27;</span> <span class="hljs-keyword">if</span> frequency <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;1M&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;day&#x27;</span>  <span class="hljs-comment"># åˆ¤æ–­æ—¥çº¿ï¼Œå‘¨çº¿ï¼Œæœˆçº¿</span><br>    <span class="hljs-keyword">if</span> end_date:<br>        end_date = end_date.strftime(<br>            <span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>) <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(end_date, datetime.date) <span class="hljs-keyword">else</span> end_date.split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    end_date = <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">if</span> end_date == datetime.datetime.now().strftime(<br>        <span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>) <span class="hljs-keyword">else</span> end_date  <span class="hljs-comment"># å¦‚æœæ—¥æœŸä»Šå¤©å°±å˜æˆç©º</span><br>    URL = <span class="hljs-string">f&#x27;http://web.ifzq.gtimg.cn/appstock/app/fqkline/get?param=<span class="hljs-subst">&#123;</span></span><br><span class="hljs-subst"><span class="hljs-string">        code&#125;</span>,<span class="hljs-subst">&#123;unit&#125;</span>,,<span class="hljs-subst">&#123;end_date&#125;</span>,<span class="hljs-subst">&#123;count&#125;</span>,qfq&#x27;</span><br>    st = json.loads(requests.get(URL).content)<br>    ms = <span class="hljs-string">&#x27;qfq&#x27;</span>+unit<br>    stk = st[<span class="hljs-string">&#x27;data&#x27;</span>][code]<br>    buf = stk[ms] <span class="hljs-keyword">if</span> ms <span class="hljs-keyword">in</span> stk <span class="hljs-keyword">else</span> stk[unit]  <span class="hljs-comment"># æŒ‡æ•°è¿”å›ä¸æ˜¯qfqday,æ˜¯day</span><br>    df = pd.DataFrame(<br>        buf, columns=[<span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>], dtype=<span class="hljs-string">&#x27;float&#x27;</span>)<br>    df.time = pd.to_datetime(df.time)<br>    df.set_index([<span class="hljs-string">&#x27;time&#x27;</span>], inplace=<span class="hljs-literal">True</span>)<br>    df.index.name = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># å¤„ç†ç´¢å¼•</span><br>    <span class="hljs-keyword">return</span> df<br><br><span class="hljs-comment"># è…¾è®¯åˆ†é’Ÿçº¿</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_price_min_tx</span>(<span class="hljs-params">code, end_date=<span class="hljs-literal">None</span>, count=<span class="hljs-number">10</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span></span>):  <span class="hljs-comment"># åˆ†é’Ÿçº¿è·å–</span><br>    ts = <span class="hljs-built_in">int</span>(frequency[:-<span class="hljs-number">1</span>]) <span class="hljs-keyword">if</span> frequency[:-<span class="hljs-number">1</span>].isdigit() <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>  <span class="hljs-comment"># è§£æKçº¿å‘¨æœŸæ•°</span><br>    <span class="hljs-keyword">if</span> end_date:<br>        end_date = end_date.strftime(<br>            <span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>) <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(end_date, datetime.date) <span class="hljs-keyword">else</span> end_date.split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    URL = <span class="hljs-string">f&#x27;http://ifzq.gtimg.cn/appstock/app/kline/mkline?param=<span class="hljs-subst">&#123;</span></span><br><span class="hljs-subst"><span class="hljs-string">        code&#125;</span>,m<span class="hljs-subst">&#123;ts&#125;</span>,,<span class="hljs-subst">&#123;count&#125;</span>&#x27;</span><br>    st = json.loads(requests.get(URL).content)<br>    buf = st[<span class="hljs-string">&#x27;data&#x27;</span>][code][<span class="hljs-string">&#x27;m&#x27;</span>+<span class="hljs-built_in">str</span>(ts)]<br>    df = pd.DataFrame(<br>        buf, columns=[<span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>, <span class="hljs-string">&#x27;n1&#x27;</span>, <span class="hljs-string">&#x27;n2&#x27;</span>])<br>    df = df[[<span class="hljs-string">&#x27;time&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>]]<br>    df[[<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>]] = df[[<br>        <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>]].astype(<span class="hljs-string">&#x27;float&#x27;</span>)<br>    df.time = pd.to_datetime(df.time)<br>    df.set_index([<span class="hljs-string">&#x27;time&#x27;</span>], inplace=<span class="hljs-literal">True</span>)<br>    df.index.name = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># å¤„ç†ç´¢å¼•</span><br>    df[<span class="hljs-string">&#x27;close&#x27;</span>][-<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(st[<span class="hljs-string">&#x27;data&#x27;</span>][code][<span class="hljs-string">&#x27;qt&#x27;</span>][code][<span class="hljs-number">3</span>])  <span class="hljs-comment"># æœ€æ–°åŸºé‡‘æ•°æ®æ˜¯3ä½çš„</span><br>    <span class="hljs-keyword">return</span> df<br><br><br><span class="hljs-comment"># sinaæ–°æµªå…¨å‘¨æœŸè·å–å‡½æ•°ï¼Œåˆ†é’Ÿçº¿ 5m,15m,30m,60m  æ—¥çº¿1d=240m   å‘¨çº¿1w=1200m  1æœˆ=7200m</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_price_sina</span>(<span class="hljs-params">code, end_date=<span class="hljs-string">&#x27;&#x27;</span>, count=<span class="hljs-number">10</span>, frequency=<span class="hljs-string">&#x27;60m&#x27;</span></span>):  <span class="hljs-comment"># æ–°æµªå…¨å‘¨æœŸè·å–å‡½æ•°</span><br>    frequency = frequency.replace(<span class="hljs-string">&#x27;1d&#x27;</span>, <span class="hljs-string">&#x27;240m&#x27;</span>).replace(<br>        <span class="hljs-string">&#x27;1w&#x27;</span>, <span class="hljs-string">&#x27;1200m&#x27;</span>).replace(<span class="hljs-string">&#x27;1M&#x27;</span>, <span class="hljs-string">&#x27;7200m&#x27;</span>)<br>    mcount = count<br>    ts = <span class="hljs-built_in">int</span>(frequency[:-<span class="hljs-number">1</span>]) <span class="hljs-keyword">if</span> frequency[:-<span class="hljs-number">1</span>].isdigit() <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>  <span class="hljs-comment"># è§£æKçº¿å‘¨æœŸæ•°</span><br>    <span class="hljs-keyword">if</span> (end_date != <span class="hljs-string">&#x27;&#x27;</span>) &amp; (frequency <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;240m&#x27;</span>, <span class="hljs-string">&#x27;1200m&#x27;</span>, <span class="hljs-string">&#x27;7200m&#x27;</span>]):<br>        end_date = pd.to_datetime(end_date) <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(<br>            end_date, datetime.date) <span class="hljs-keyword">else</span> end_date  <span class="hljs-comment"># è½¬æ¢æˆdatetime</span><br>        unit = <span class="hljs-number">4</span> <span class="hljs-keyword">if</span> frequency == <span class="hljs-string">&#x27;1200m&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-number">29</span> <span class="hljs-keyword">if</span> frequency == <span class="hljs-string">&#x27;7200m&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1</span><br>        <span class="hljs-comment"># 4,29å¤šå‡ ä¸ªæ•°æ®ä¸å½±å“é€Ÿåº¦</span><br>        <span class="hljs-comment"># ç»“æŸæ—¶é—´åˆ°ä»Šå¤©æœ‰å¤šå°‘å¤©è‡ªç„¶æ—¥(è‚¯å®š &gt;äº¤æ˜“æ—¥)</span><br>        count = count+(datetime.datetime.now()-end_date).days//unit<br>        <span class="hljs-comment"># print(code,end_date,count)</span><br>    URL = <span class="hljs-string">f&#x27;http://money.finance.sina.com.cn/quotes_service/api/json_v2.php/CN_MarketData.getKLineData?symbol=<span class="hljs-subst">&#123;</span></span><br><span class="hljs-subst"><span class="hljs-string">        code&#125;</span>&amp;scale=<span class="hljs-subst">&#123;ts&#125;</span>&amp;ma=5&amp;datalen=<span class="hljs-subst">&#123;count&#125;</span>&#x27;</span><br>    dstr = json.loads(requests.get(URL).content)<br>    <span class="hljs-comment"># df=pd.DataFrame(dstr,columns=[&#x27;day&#x27;,&#x27;open&#x27;,&#x27;high&#x27;,&#x27;low&#x27;,&#x27;close&#x27;,&#x27;volume&#x27;],dtype=&#x27;float&#x27;)</span><br>    df = pd.DataFrame(<br>        dstr, columns=[<span class="hljs-string">&#x27;day&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-string">&#x27;volume&#x27;</span>])<br>    df[<span class="hljs-string">&#x27;open&#x27;</span>] = df[<span class="hljs-string">&#x27;open&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>    df[<span class="hljs-string">&#x27;high&#x27;</span>] = df[<span class="hljs-string">&#x27;high&#x27;</span>].astype(<span class="hljs-built_in">float</span>)  <span class="hljs-comment"># è½¬æ¢æ•°æ®ç±»å‹</span><br>    df[<span class="hljs-string">&#x27;low&#x27;</span>] = df[<span class="hljs-string">&#x27;low&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>    df[<span class="hljs-string">&#x27;close&#x27;</span>] = df[<span class="hljs-string">&#x27;close&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>    df[<span class="hljs-string">&#x27;volume&#x27;</span>] = df[<span class="hljs-string">&#x27;volume&#x27;</span>].astype(<span class="hljs-built_in">float</span>)<br>    df.day = pd.to_datetime(df.day)<br>    df.set_index([<span class="hljs-string">&#x27;day&#x27;</span>], inplace=<span class="hljs-literal">True</span>)<br>    df.index.name = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># å¤„ç†ç´¢å¼•</span><br>    <span class="hljs-keyword">if</span> (end_date != <span class="hljs-string">&#x27;&#x27;</span>) &amp; (frequency <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;240m&#x27;</span>, <span class="hljs-string">&#x27;1200m&#x27;</span>, <span class="hljs-string">&#x27;7200m&#x27;</span>]):<br>        <span class="hljs-keyword">return</span> df[df.index &lt;= end_date][-mcount:]  <span class="hljs-comment"># æ—¥çº¿å¸¦ç»“æŸæ—¶é—´å…ˆè¿”å›</span><br>    <span class="hljs-keyword">return</span> df<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_price</span>(<span class="hljs-params">code, end_date=<span class="hljs-string">&#x27;&#x27;</span>, count=<span class="hljs-number">10</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span>, fields=[]</span>):<br>    <span class="hljs-comment"># å¯¹å¤–æš´éœ²åªæœ‰å”¯ä¸€å‡½æ•°ï¼Œè¿™æ ·å¯¹ç”¨æˆ·æ‰æ˜¯æœ€å‹å¥½çš„</span><br>    xcode = code.replace(<span class="hljs-string">&#x27;.XSHG&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;.XSHE&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment"># è¯åˆ¸ä»£ç ç¼–ç å…¼å®¹å¤„ç†</span><br>    xcode = <span class="hljs-string">&#x27;sh&#x27;</span>+xcode <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;XSHG&#x27;</span> <span class="hljs-keyword">in</span> code) <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;sz&#x27;</span> + \<br>        xcode <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;XSHE&#x27;</span> <span class="hljs-keyword">in</span> code) <span class="hljs-keyword">else</span> code<br><br>    <span class="hljs-keyword">if</span> frequency <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;1d&#x27;</span>, <span class="hljs-string">&#x27;1w&#x27;</span>, <span class="hljs-string">&#x27;1M&#x27;</span>]:  <span class="hljs-comment"># 1dæ—¥çº¿  1wå‘¨çº¿  1Mæœˆçº¿</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># ä¸»åŠ›</span><br>            <span class="hljs-keyword">return</span> get_price_sina(xcode, end_date=end_date, count=count, frequency=frequency)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-comment"># å¤‡ç”¨</span><br>            <span class="hljs-keyword">return</span> get_price_day_tx(xcode, end_date=end_date, count=count, frequency=frequency)<br><br>    <span class="hljs-keyword">if</span> frequency <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;1m&#x27;</span>, <span class="hljs-string">&#x27;5m&#x27;</span>, <span class="hljs-string">&#x27;15m&#x27;</span>, <span class="hljs-string">&#x27;30m&#x27;</span>, <span class="hljs-string">&#x27;60m&#x27;</span>]:  <span class="hljs-comment"># åˆ†é’Ÿçº¿ ,1måªæœ‰è…¾è®¯æ¥å£  5åˆ†é’Ÿ5m   60åˆ†é’Ÿ60m</span><br>        <span class="hljs-keyword">if</span> frequency <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;1m&#x27;</span>:<br>            <span class="hljs-keyword">return</span> get_price_min_tx(xcode, end_date=end_date, count=count, frequency=frequency)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># ä¸»åŠ›</span><br>            <span class="hljs-keyword">return</span> get_price_sina(xcode, end_date=end_date, count=count, frequency=frequency)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-comment"># å¤‡ç”¨</span><br>            <span class="hljs-keyword">return</span> get_price_min_tx(xcode, end_date=end_date, count=count, frequency=frequency)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    df = get_price(<span class="hljs-string">&#x27;sh000001&#x27;</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span>,<br>                   count=<span class="hljs-number">10</span>)  <span class="hljs-comment"># æ”¯æŒ&#x27;1d&#x27;æ—¥, &#x27;1w&#x27;å‘¨, &#x27;1M&#x27;æœˆ</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ä¸Šè¯æŒ‡æ•°æ—¥çº¿è¡Œæƒ…\n&#x27;</span>, df)<br><br>    <span class="hljs-comment"># æ”¯æŒ&#x27;1m&#x27;,&#x27;5m&#x27;,&#x27;15m&#x27;,&#x27;30m&#x27;,&#x27;60m&#x27;</span><br>    df = get_price(<span class="hljs-string">&#x27;000001.XSHG&#x27;</span>, frequency=<span class="hljs-string">&#x27;15m&#x27;</span>, count=<span class="hljs-number">10</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ä¸Šè¯æŒ‡æ•°åˆ†é’Ÿçº¿\n&#x27;</span>, df)<br><br><span class="hljs-comment"># Ashare è‚¡ç¥¨è¡Œæƒ…æ•°æ®( https://github.com/mpquant/Ashare )</span><br><br><br><br><span class="hljs-comment"># å…·ä½“ç”¨æ³•</span><br><span class="hljs-comment"># -*- coding:utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;è·å–è‚¡ç¥¨å†å²ä»·æ ¼&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> Ashare<br><br>gupiao = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;è¾“å…¥ä»£ç ï¼š&#x27;</span>)<br><span class="hljs-comment"># countä¸ºæƒ³è¦è·å–çš„å¤©æ•°</span><br><span class="hljs-keyword">if</span> gupiao[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;6&#x27;</span>:<br>	df = Ashare.get_price(<span class="hljs-string">f&#x27;sh<span class="hljs-subst">&#123;gupiao&#125;</span>&#x27;</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span>, count=<span class="hljs-number">100</span>)<br><span class="hljs-keyword">else</span>:<br>    df = Ashare.get_price(<span class="hljs-string">f&#x27;sz<span class="hljs-subst">&#123;gupiao&#125;</span>&#x27;</span>, frequency=<span class="hljs-string">&#x27;1d&#x27;</span>, count=<span class="hljs-number">100</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ä¸Šè¯æŒ‡æ•°å†å²è¡Œæƒ…\n&#x27;</span>, df)<br><br>output_File = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;gupiao&#125;</span>&#x27;</span><br>df.to_csv(<span class="hljs-string">f&#x27;data_<span class="hljs-subst">&#123;output_File&#125;</span>.csv&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ•°æ®å·²ç»å­˜å‚¨åˆ°data_<span class="hljs-subst">&#123;output_File&#125;</span>.csv&quot;</span>)<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" class="category-chain-item">è®¡ç®—æœº</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%BC%96%E7%A8%8B/" class="print-no-link">#ç¼–ç¨‹</a>
      
        <a href="/tags/python/" class="print-no-link">#python</a>
      
        <a href="/tags/AI/" class="print-no-link">#AI</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ç¥ç»å…ƒå­¦ä¹ </div>
      <div>http://example.com/2024/10/04/2024-10-04-ç¥ç»å…ƒå­¦ä¹ /</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>zqten</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´10æœˆ4æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/10/04/2024-10-04-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="ç¥ç»ç½‘ç»œç¼–ç¨‹">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ç¥ç»ç½‘ç»œç¼–ç¨‹</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/10/03/2024-10-03-Python%E6%89%93%E5%8C%85exe%E6%96%87%E4%BB%B6/" title="ç”¨Pythonæ‰“åŒ…exeæ–‡ä»¶">
                        <span class="hidden-mobile">ç”¨Pythonæ‰“åŒ…exeæ–‡ä»¶</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://zqten.github.io/" target="_blank" rel="nofollow noopener"><span>Zqten</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Freedom-Fluid</span></a>  
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
